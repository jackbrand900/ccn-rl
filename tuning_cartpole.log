/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/pygame/pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/gym/envs/registration.py:307: DeprecationWarning: The package name gym_minigrid has been deprecated in favor of minigrid. Please uninstall gym_minigrid and install minigrid with `pip install minigrid`. Future releases will be maintained under the new package name minigrid.
  fn()
Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[I 2025-12-26 15:07:35,017] A new study created in RDB with name: ijcai_cpo_CartPole-v1

################################################################################
# Hyperparameter Tuning for IJCAI Experiments
# Environment: CartPole-v1
# Target Reward: 150.0
# Methods: 10
# Trials per method: 20
################################################################################


================================================================================
Tuning: CPO on CartPole-v1
Target reward: 150.0
Trials: 20
================================================================================

  0%|          | 0/20 [00:00<?, ?it/s]                                        0%|          | 0/20 [00:00<?, ?it/s]Best trial: 0. Best value: -1000:   0%|          | 0/20 [00:00<?, ?it/s]Best trial: 0. Best value: -1000:   5%|▌         | 1/20 [00:00<00:18,  1.01it/s]                                                                                Best trial: 0. Best value: -1000:   5%|▌         | 1/20 [00:01<00:18,  1.01it/s]Best trial: 0. Best value: -1000:   5%|▌         | 1/20 [00:01<00:18,  1.01it/s]                                                                                Best trial: 0. Best value: -1000:  10%|█         | 2/20 [00:01<00:17,  1.01it/s]Best trial: 0. Best value: -1000:  10%|█         | 2/20 [00:01<00:17,  1.01it/s]Best trial: 0. Best value: -1000:  15%|█▌        | 3/20 [00:01<00:05,  2.96it/s]                                                                                Best trial: 0. Best value: -1000:  15%|█▌        | 3/20 [00:01<00:05,  2.96it/s]Best trial: 0. Best value: -1000:  15%|█▌        | 3/20 [00:01<00:05,  2.96it/s][Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x14dec56d0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14dec6110>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x14ded6810>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14ded6790>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x14ded6d50>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training CPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
Error in trial: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
[I 2025-12-26 15:07:36,021] Trial 0 finished with value: -1000.0 and parameters: {'lr': 0.001123686808584513, 'gamma': 0.9263436514789591, 'hidden_dim': 256, 'use_orthogonal_init': True, 'num_layers': 2, 'cost_gamma': 0.9626876010433673, 'cost_lam': 0.9954170172011981, 'clip_eps': 0.1462846014891906, 'ent_coef': 0.016370650811681153, 'epochs': 3, 'batch_size': 64, 'budget': 0.16002773819983063, 'max_kl': 0.012663321544047671}. Best is trial 0 with value: -1000.0.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x10a036ad0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x12e3d8cd0>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x14debc290>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14debd210>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x14e0e3d50>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training CPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
Error in trial: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
[I 2025-12-26 15:07:36,093] Trial 1 finished with value: -1000.0 and parameters: {'lr': 0.0006141935926835352, 'gamma': 0.9142127360837575, 'hidden_dim': 128, 'use_orthogonal_init': True, 'num_layers': 2, 'cost_gamma': 0.9232572218409656, 'cost_lam': 0.9392024713066641, 'clip_eps': 0.16817430949973394, 'ent_coef': 0.0007972716640994193, 'epochs': 7, 'batch_size': 32, 'budget': 0.2005105235357712, 'max_kl': 0.015048442210891497}. Best is trial 0 with value: -1000.0.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5710>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5690>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5e90>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5e10>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5e10>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training CPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
Error in trial: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
[I 2025-12-26 15:07:36,239] Trial 2 finished with value: -1000.0 and parameters: {'lr': 0.003123576501872564, 'gamma': 0.9167543822329369, 'hidden_dim': 256, 'use_orthogonal_init': True, 'num_layers': 4, 'cost_gamma': 0.9172079968916961, 'cost_lam': 0.9900856080034097, 'clip_eps': 0.29493372429773124, 'ent_coef': 0.002260166645674289, 'epochs': 3, 'batch_size': 64, 'budget': 0.29512958153062047, 'max_kl': 0.005910095728311694}. Best is trial 0 with value: -1000.0.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5850>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b46d0>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5e50>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b60d0>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5b10>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training CPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
Error in trial: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
[I 2025-12-26 15:07:36,332] Trial 3 finished with value: -1000.0 and parameters: {'lr': 0.0005420998278051508, 'gamma': 0.9446336595742206, 'hidden_dim': 512, 'use_orthogonal_init': True, 'num_layers': 3, 'cost_gamma': 0.9943142689067617, 'cost_lam': 0.934455668927671, 'clip_eps': 0.12482009921707593, 'ent_coef': 0.046356479646940486, 'epochs': 6, 'batch_size': 32, 'budget': 0.08719048151015373, 'max_kl': 0.009726136829847418}. Best is trial 0 with value: -1000.0.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5090>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14ec746d0>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5810>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14e1b5010>]                                                                                Best trial: 0. Best value: -1000:  20%|██        | 4/20 [00:01<00:05,  2.96it/s]Best trial: 0. Best value: -1000:  20%|██        | 4/20 [00:01<00:05,  2.96it/s]Best trial: 0. Best value: -1000:  25%|██▌       | 5/20 [00:01<00:03,  4.83it/s]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x14ded6e90>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training CPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
Error in trial: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
[I 2025-12-26 15:07:36,405] Trial 4 finished with value: -1000.0 and parameters: {'lr': 0.00019415283101325176, 'gamma': 0.9945312027532892, 'hidden_dim': 128, 'use_orthogonal_init': True, 'num_layers': 2, 'cost_gamma': 0.9221458795583125, 'cost_lam': 0.9491357686184522, 'clip_eps': 0.12497346316473974, 'ent_coef': 0.00757040295877583, 'epochs': 7, 'batch_size': 32, 'budget': 0.1581611484683456, 'max_kl': 0.009786948958099607}. Best is trial 0 with value: -1000.0.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x14ed17890>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14ed067d0>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x14f840610>] [<pishield.propositional_requirements.constraint.Constraint object at 0x14ed16790>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x14abf86d0>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training CPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 62.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 39, Viol Rate:  0.062
[Checkpoint] New best avg reward: 62.50 at episode 10
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 53.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 78, Viol Rate:  0.067
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 40.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 110, Viol Rate:  0.070
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 63.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 151, Viol Rate:  0.069
[Checkpoint] New best avg reward: 63.30 at episode 40
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 43.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 190, Viol Rate:  0.072
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 45.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 211, Viol Rate:  0.068
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 31.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 235, Viol Rate:  0.069
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 54.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 256, Viol Rate:  0.065
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 45.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 282, Viol Rate:  0.064
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 39.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 314, Viol Rate:  0.065
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 47.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 340, Viol Rate:  0.065
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 87.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 419, Viol Rate:  0.068
[Checkpoint] New best avg reward: 87.20 at episode 120
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 64.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 471, Viol Rate:  0.069
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 50.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 518, Viol Rate:  0.071
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 34.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 540, Viol Rate:  0.071
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 35.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 561, Viol Rate:  0.070
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 46.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 601, Viol Rate:  0.071
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 63.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 663, Viol Rate:  0.073
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 41.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 688, Viol Rate:  0.072
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 35.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 720, Viol Rate:  0.073
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 49.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 760, Viol Rate:  0.073
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 47.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 807, Viol Rate:  0.075
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 29.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 827, Viol Rate:  0.074
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 58.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 878, Viol Rate:  0.075
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 34.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 907, Viol Rate:  0.075
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 24.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 925, Viol Rate:  0.075
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 58.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 970, Viol Rate:  0.075
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 43.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 998, Viol Rate:  0.075
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 39.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1025, Viol Rate:  0.075
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 46.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1057, Viol Rate:  0.075
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 43.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1085, Viol Rate:  0.074
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 36.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1123, Viol Rate:  0.075
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 46.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1175, Viol Rate:  0.076
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 37.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1196, Viol Rate:  0.076
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 56.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1258, Viol Rate:  0.077
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 44.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1302, Viol Rate:  0.077
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 33.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1337, Viol Rate:  0.078
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 59.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1383, Viol Rate:  0.078
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 68.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1447, Viol Rate:  0.079
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 37.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1486, Viol Rate:  0.079
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 53.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1541, Viol Rate:  0.080
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 31.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1557, Viol Rate:  0.079
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 53.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1609, Viol Rate:  0.080
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 34.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1640, Viol Rate:  0.080
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 39.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1680, Viol Rate:  0.080
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 29.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1706, Viol Rate:  0.080
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 73.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1773, Viol Rate:  0.081
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 36.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1796, Viol Rate:  0.080
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 49.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1830, Viol Rate:  0.080
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 51.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1876, Viol Rate:  0.080

[Post-Training] Loading best weights with avg reward: 87.20

[Evaluation] Evaluating CPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 23.00, Steps = 23, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0435
Episode 2/50: Reward = 19.00, Steps = 19, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 2, Mod Rate = 0.0000, Viol Rate = 0.0476
Episode 3/50: Reward = 87.00, Steps = 87, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 12, Mod Rate = 0.0000, Viol Rate = 0.0930
Episode 4/50: Reward = 62.00, Steps = 62, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 22, Mod Rate = 0.0000, Viol Rate = 0.1152
Episode 5/50: Reward = 31.00, Steps = 31, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 27, Mod Rate = 0.0000, Viol Rate = 0.1216
Episode 6/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 28, Mod Rate = 0.0000, Viol Rate = 0.1186
Episode 7/50: Reward = 16.00, Steps = 16, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 30, Mod Rate = 0.0000, Viol Rate = 0.1190
Episode 8/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 30, Mod Rate = 0.0000, Viol Rate = 0.1128
Episode 9/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 32, Mod Rate = 0.0000, Viol Rate = 0.1143
Episode 10/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 32, Mod Rate = 0.0000, Viol Rate = 0.1096
Episode 11/50: Reward = 37.00, Steps = 37, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 32, Mod Rate = 0.0000, Viol Rate = 0.0973
Episode 12/50: Reward = 82.00, Steps = 82, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 38, Mod Rate = 0.0000, Viol Rate = 0.0925
Episode 13/50: Reward = 22.00, Steps = 22, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 38, Mod Rate = 0.0000, Viol Rate = 0.0878
Episode 14/50: Reward = 19.00, Steps = 19, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.0863
Episode 15/50: Reward = 124.00, Steps = 124, Episode Modifications = 0, Episode Violations = 11, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.0868
Episode 16/50: Reward = 64.00, Steps = 64, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 55, Mod Rate = 0.0000, Viol Rate = 0.0859
Episode 17/50: Reward = 121.00, Steps = 121, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0815
Episode 18/50: Reward = 36.00, Steps = 36, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 68, Mod Rate = 0.0000, Viol Rate = 0.0853
Episode 19/50: Reward = 17.00, Steps = 17, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 69, Mod Rate = 0.0000, Viol Rate = 0.0848
Episode 20/50: Reward = 158.00, Steps = 158, Episode Modifications = 0, Episode Violations = 11, Total Modifications = 0, Total Violations = 80, Mod Rate = 0.0000, Viol Rate = 0.0823
Episode 21/50: Reward = 37.00, Steps = 37, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 81, Mod Rate = 0.0000, Viol Rate = 0.0803
Episode 22/50: Reward = 147.00, Steps = 147, Episode Modifications = 0, Episode Violations = 21, Total Modifications = 0, Total Violations = 102, Mod Rate = 0.0000, Viol Rate = 0.0882
Episode 23/50: Reward = 131.00, Steps = 131, Episode Modifications = 0, Episode Violations = 15, Total Modifications = 0, Total Violations = 117, Mod Rate = 0.0000, Viol Rate = 0.0909
Episode 24/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 119, Mod Rate = 0.0000, Viol Rate = 0.0917
Episode 25/50: Reward = 35.00, Steps = 35, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 120, Mod Rate = 0.0000, Viol Rate = 0.0900
Episode 26/50: Reward = 25.00, Steps = 25, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 122, Mod Rate = 0.0000, Viol Rate = 0.0898
Episode 27/50: Reward = 36.00, Steps = 36, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 126, Mod Rate = 0.0000, Viol Rate = 0.0904
Episode 28/50: Reward = 87.00, Steps = 87, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 134, Mod Rate = 0.0000, Viol Rate = 0.0905
Episode 29/50: Reward = 19.00, Steps = 19, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 134, Mod Rate = 0.0000, Viol Rate = 0.0893
Episode 30/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 135, Mod Rate = 0.0000, Viol Rate = 0.0895
Episode 31/50: Reward = 24.00, Steps = 24, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 135, Mod Rate = 0.0000, Viol Rate = 0.0881
Episode 32/50: Reward = 17.00, Steps = 17, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 136, Mod Rate = 0.0000, Viol Rate = 0.0877
Episode 33/50: Reward = 19.00, Steps = 19, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 137, Mod Rate = 0.0000, Viol Rate = 0.0873
Episode 34/50: Reward = 70.00, Steps = 70, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 143, Mod Rate = 0.0000, Viol Rate = 0.0872                                                                                Best trial: 0. Best value: -1000:  25%|██▌       | 5/20 [00:57<00:03,  4.83it/s]Best trial: 5. Best value: -0.682133:  25%|██▌       | 5/20 [00:57<00:03,  4.83it/s]Best trial: 5. Best value: -0.682133:  30%|███       | 6/20 [00:57<03:32, 15.21s/it]                                                                                    Best trial: 5. Best value: -0.682133:  30%|███       | 6/20 [00:57<03:32, 15.21s/it]Best trial: 5. Best value: -0.682133:  30%|███       | 6/20 [00:57<03:32, 15.21s/it]Best trial: 5. Best value: -0.682133:  35%|███▌      | 7/20 [00:57<02:23, 11.08s/it]                                                                                    Best trial: 5. Best value: -0.682133:  35%|███▌      | 7/20 [00:58<02:23, 11.08s/it]Best trial: 5. Best value: -0.682133:  35%|███▌      | 7/20 [00:58<02:23, 11.08s/it]Best trial: 5. Best value: -0.682133:  40%|████      | 8/20 [00:58<01:36,  8.04s/it]
Episode 35/50: Reward = 18.00, Steps = 18, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 146, Mod Rate = 0.0000, Viol Rate = 0.0881
Episode 36/50: Reward = 42.00, Steps = 42, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 151, Mod Rate = 0.0000, Viol Rate = 0.0889
Episode 37/50: Reward = 65.00, Steps = 65, Episode Modifications = 0, Episode Violations = 12, Total Modifications = 0, Total Violations = 163, Mod Rate = 0.0000, Viol Rate = 0.0924
Episode 38/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 165, Mod Rate = 0.0000, Viol Rate = 0.0929
Episode 39/50: Reward = 112.00, Steps = 112, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 172, Mod Rate = 0.0000, Viol Rate = 0.0911
Episode 40/50: Reward = 24.00, Steps = 24, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 174, Mod Rate = 0.0000, Viol Rate = 0.0910
Episode 41/50: Reward = 18.00, Steps = 18, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 176, Mod Rate = 0.0000, Viol Rate = 0.0911
Episode 42/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 177, Mod Rate = 0.0000, Viol Rate = 0.0911
Episode 43/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 178, Mod Rate = 0.0000, Viol Rate = 0.0910
Episode 44/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 178, Mod Rate = 0.0000, Viol Rate = 0.0903
Episode 45/50: Reward = 50.00, Steps = 50, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 179, Mod Rate = 0.0000, Viol Rate = 0.0885
Episode 46/50: Reward = 111.00, Steps = 111, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 189, Mod Rate = 0.0000, Viol Rate = 0.0886
Episode 47/50: Reward = 34.00, Steps = 34, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 193, Mod Rate = 0.0000, Viol Rate = 0.0891
Episode 48/50: Reward = 144.00, Steps = 144, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 203, Mod Rate = 0.0000, Viol Rate = 0.0878
Episode 49/50: Reward = 24.00, Steps = 24, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 203, Mod Rate = 0.0000, Viol Rate = 0.0869
Episode 50/50: Reward = 49.00, Steps = 49, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 204, Mod Rate = 0.0000, Viol Rate = 0.0856

Evaluation Summary:
Average Reward: 47.68
Standard Deviation: 41.93
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 204
Avg Constraint Violations per Step: 0.0856
[I 2025-12-26 15:08:32,465] Trial 5 finished with value: -0.6821333287857778 and parameters: {'lr': 0.0008544064740315346, 'gamma': 0.9529657262353596, 'hidden_dim': 256, 'use_orthogonal_init': False, 'num_layers': 3, 'cost_gamma': 0.9336811069694781, 'cost_lam': 0.9935816672611463, 'clip_eps': 0.2635233323165644, 'ent_coef': 0.029015354100404723, 'epochs': 10, 'batch_size': 128, 'budget': 0.21326332346316434, 'max_kl': 0.008843109002801847}. Best is trial 5 with value: -0.6821333287857778.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x337464cd0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x33745d7d0>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x3374ad4d0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3374a5f50>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x3374dffd0>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training CPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
Error in trial: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
[I 2025-12-26 15:08:32,765] Trial 6 finished with value: -1000.0 and parameters: {'lr': 0.0020585281645550428, 'gamma': 0.9208941487839666, 'hidden_dim': 512, 'use_orthogonal_init': True, 'num_layers': 3, 'cost_gamma': 0.9986890029019083, 'cost_lam': 0.9537924301106522, 'clip_eps': 0.24136544170605845, 'ent_coef': 0.025056207358627125, 'epochs': 2, 'batch_size': 128, 'budget': 0.29907136791652594, 'max_kl': 0.014616227980322577}. Best is trial 5 with value: -0.6821333287857778.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x14ecc9ad0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3372f7150>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x33750c510>] [<pishield.propositional_requirements.constraint.Constraint object at 0x33750c410>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x33764f810>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training CPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
Error in trial: One of the differentiated Tensors appears to not have been used in the graph. Set allow_unused=True if this is the desired behavior.
[I 2025-12-26 15:08:33,149] Trial 7 finished with value: -1000.0 and parameters: {'lr': 0.0009914010333383053, 'gamma': 0.9492556764625951, 'hidden_dim': 128, 'use_orthogonal_init': True, 'num_layers': 3, 'cost_gamma': 0.9561288476881311, 'cost_lam': 0.988843066184978, 'clip_eps': 0.12198540746118172, 'ent_coef': 0.03376114244111989, 'epochs': 5, 'batch_size': 128, 'budget': 0.08191438206567812, 'max_kl': 0.011207641920426599}. Best is trial 5 with value: -0.6821333287857778.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x337365010>] [<pishield.propositional_requirements.constraint.Constraint object at 0x337326f90>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x339b59dd0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x339b58b50>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x33748b790>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training CPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 19.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 22, Viol Rate:  0.111
[Checkpoint] New best avg reward: 19.80 at episode 10
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 26.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 52, Viol Rate:  0.112
[Checkpoint] New best avg reward: 26.70 at episode 20
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 19.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 77, Viol Rate:  0.117
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 16.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 94, Viol Rate:  0.114
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 22.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 115, Viol Rate:  0.109
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 26.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 140, Viol Rate:  0.106
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 22.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 163, Viol Rate:  0.106
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 34.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 190, Viol Rate:  0.101
[Checkpoint] New best avg reward: 34.30 at episode 80
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 18.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 207, Viol Rate:  0.100
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 23.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 233, Viol Rate:  0.101
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 35.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 259, Viol Rate:  0.097
[Checkpoint] New best avg reward: 35.20 at episode 110
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 21.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 274, Viol Rate:  0.095
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 32.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 306, Viol Rate:  0.096
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 32.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 325, Viol Rate:  0.092
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 39.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 360, Viol Rate:  0.092
[Checkpoint] New best avg reward: 39.10 at episode 150
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 28.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 391, Viol Rate:  0.093
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 25.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 412, Viol Rate:  0.092
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 28.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 437, Viol Rate:  0.092
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 29.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 466, Viol Rate:  0.092
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 36.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 499, Viol Rate:  0.092
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 19.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 515, Viol Rate:  0.092
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 29.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 537, Viol Rate:  0.091
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 26.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 555, Viol Rate:  0.090
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 36.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 576, Viol Rate:  0.088
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 36.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 608, Viol Rate:  0.088
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 18.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 621, Viol Rate:  0.088
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 33.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 653, Viol Rate:  0.088
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 29.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 671, Viol Rate:  0.087
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 30.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 695, Viol Rate:  0.087
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 40.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 734, Viol Rate:  0.087
[Checkpoint] New best avg reward: 40.20 at episode 300
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 21.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 755, Viol Rate:  0.088
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 22.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 771, Viol Rate:  0.087
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 26.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 794, Viol Rate:  0.087
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 20.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 812, Viol Rate:  0.087
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 23.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 834, Viol Rate:  0.087
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 37.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 872, Viol Rate:  0.088
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 32.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 900, Viol Rate:  0.088
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 22.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 915, Viol Rate:  0.087
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 26.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 938, Viol Rate:  0.087
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 42.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 963, Viol Rate:  0.086
[Checkpoint] New best avg reward: 42.70 at episode 400
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 24.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 984, Viol Rate:  0.086
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 20.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 999, Viol Rate:  0.086
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 28.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1025, Viol Rate:  0.086
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 43.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1070, Viol Rate:  0.087
[Checkpoint] New best avg reward: 43.90 at episode 440
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 26.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1090, Viol Rate:  0.086
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 23.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1103, Viol Rate:  0.086
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 28.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1117, Viol Rate:  0.085
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 20.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1138, Viol Rate:  0.085
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 20.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1152, Viol Rate:  0.085
[CartPole-v1] [CPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 21.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1165, Viol Rate:  0.085

[Post-Training] Loading best weights with avg reward: 43.90

[Evaluation] Evaluating CPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0714
Episode 2/50: Reward = 19.00, Steps = 19, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 2, Mod Rate = 0.0000, Viol Rate = 0.0606
Episode 3/50: Reward = 37.00, Steps = 37, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 3, Mod Rate = 0.0000, Viol Rate = 0.0429
Episode 4/50: Reward = 32.00, Steps = 32, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 4, Mod Rate = 0.0000, Viol Rate = 0.0392
Episode 5/50: Reward = 21.00, Steps = 21, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 5, Mod Rate = 0.0000, Viol Rate = 0.0407
Episode 6/50: Reward = 31.00, Steps = 31, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0455
Episode 7/50: Reward = 18.00, Steps = 18, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0407
Episode 8/50: Reward = 23.00, Steps = 23, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0410
Episode 9/50: Reward = 19.00, Steps = 19, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0374
Episode 10/50: Reward = 27.00, Steps = 27, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 9, Mod Rate = 0.0000, Viol Rate = 0.0373
Episode 11/50: Reward = 96.00, Steps = 96, Episode Modifications = 0, Episode Violations = 16, Total Modifications = 0, Total Violations = 25, Mod Rate = 0.0000, Viol Rate = 0.0742
Episode 12/50: Reward = 29.00, Steps = 29, Episode Modifications = 0, Episode Violations = 9, Total Modifications = 0, Total Violations = 34, Mod Rate = 0.0000, Viol Rate = 0.0929
Episode 13/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 34, Mod Rate = 0.0000, Viol Rate = 0.0897
Episode 14/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 35, Mod Rate = 0.0000, Viol Rate = 0.0888
Episode 15/50: Reward = 18.00, Steps = 18, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 37, Mod Rate = 0.0000, Viol Rate = 0.0898
Episode 16/50: Reward = 37.00, Steps = 37, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 40, Mod Rate = 0.0000, Viol Rate = 0.0891
Episode 17/50: Reward = 23.00, Steps = 23, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 42, Mod Rate = 0.0000, Viol Rate = 0.0890
Episode 18/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 43, Mod Rate = 0.0000, Viol Rate = 0.0892
Episode 19/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 44, Mod Rate = 0.0000, Viol Rate = 0.0896
Episode 20/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 45, Mod Rate = 0.0000, Viol Rate = 0.0898
Episode 21/50: Reward = 16.00, Steps = 16, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 46, Mod Rate = 0.0000, Viol Rate = 0.0890
Episode 22/50: Reward = 20.00, Steps = 20, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 46, Mod Rate = 0.0000, Viol Rate = 0.0857
Episode 23/50: Reward = 32.00, Steps = 32, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 51, Mod Rate = 0.0000, Viol Rate = 0.0896
Episode 24/50: Reward = 28.00, Steps = 28, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 51, Mod Rate = 0.0000, Viol Rate = 0.0854
Episode 25/50: Reward = 37.00, Steps = 37, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 61, Mod Rate = 0.0000, Viol Rate = 0.0962
Episode 26/50: Reward = 22.00, Steps = 22, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 64, Mod Rate = 0.0000, Viol Rate = 0.0976
Episode 27/50: Reward = 17.00, Steps = 17, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 66, Mod Rate = 0.0000, Viol Rate = 0.0981
Episode 28/50: Reward = 16.00, Steps = 16, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 68, Mod Rate = 0.0000, Viol Rate = 0.0987
Episode 29/50: Reward = 23.00, Steps = 23, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 70, Mod Rate = 0.0000, Viol Rate = 0.0983
Episode 30/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 70, Mod Rate = 0.0000, Viol Rate = 0.0966
Episode 31/50: Reward = 38.00, Steps = 38, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 71, Mod Rate = 0.0000, Viol Rate = 0.0931
Episode 32/50: Reward = 16.00, Steps = 16, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 73, Mod Rate = 0.0000, Viol Rate = 0.0937
Episode 33/50: Reward = 24.00, Steps = 24, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 75, Mod Rate = 0.0000, Viol Rate = 0.0934
Episode 34/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 76, Mod Rate = 0.0000, Viol Rate = 0.0935
Episode 35/50: Reward = 66.00, Steps = 66, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 78, Mod Rate = 0.0000, Viol Rate = 0.0887
Episode 36/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 79, Mod Rate = 0.0000, Viol Rate = 0.0888
Episode 37/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 81, Mod Rate = 0.0000, Viol Rate = 0.0896
Episode 38/50: Reward = 83.00, Steps = 83, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 82, Mod Rate = 0.0000, Viol Rate = 0.0831
Episode 39/50: Reward = 51.00, Steps = 51, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 89, Mod Rate = 0.0000, Viol Rate = 0.0857
Episode 40/50: Reward = 32.00, Steps = 32, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 94, Mod Rate = 0.0000, Viol Rate = 0.0879
Episode 41/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 95, Mod Rate = 0.0000, Viol Rate = 0.0879
Episode 42/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 97, Mod Rate = 0.0000, Viol Rate = 0.0887
Episode 43/50: Reward = 18.00, Steps = 18, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 99, Mod Rate = 0.0000, Viol Rate = 0.0890Best trial: 5. Best value: -0.682133:  40%|████      | 8/20 [02:47<04:11, 20.94s/it]
Traceback (most recent call last):
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: attempt to write a readonly database

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/optuna/storages/_rdb/storage.py", line 78, in _create_scoped_session
    session.commit()
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
    self._flush(objects)
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
    with util.safe_reraise():
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
    flush_context.execute()
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) attempt to write a readonly database
[SQL: UPDATE trials SET state=?, datetime_complete=? WHERE trials.trial_id = ?]
[parameters: ('COMPLETE', '2025-12-26 15:10:22.584991', 9)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/optuna/study/_optimize.py", line 213, in _run_trial
    frozen_trial, warning_message = _tell_with_warning(
                                    ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/optuna/study/_tell.py", line 175, in _tell_with_warning
    study._storage.set_trial_state_values(frozen_trial._trial_id, state, values)
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/optuna/storages/_cached_storage.py", line 185, in set_trial_state_values
    return self._backend.set_trial_state_values(trial_id, state=state, values=values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/optuna/storages/_rdb/storage.py", line 624, in set_trial_state_values
    with _create_scoped_session(self.scoped_session) as session:
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/optuna/storages/_rdb/storage.py", line 95, in _create_scoped_session
    raise optuna.exceptions.StorageInternalError(message) from e
optuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jackbrand/Desktop/coding/imperial/ccn-rl/scripts/tune_ijcai_methods.py", line 413, in main
    params, actual_reward = tune_method(
                            ^^^^^^^^^^^^
  File "/Users/jackbrand/Desktop/coding/imperial/ccn-rl/scripts/tune_ijcai_methods.py", line 288, in tune_method
    study.optimize(
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/optuna/study/study.py", line 489, in optimize
    _optimize(
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/optuna/study/_optimize.py", line 64, in _optimize
    _optimize_sequential(
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/optuna/study/_optimize.py", line 161, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/optuna/study/_optimize.py", line 246, in _run_trial
    assert False, "Should not reach."
           ^^^^^
AssertionError: Should not reach.
[I 2025-12-26 15:10:22,644] A new study created in RDB with name: ijcai_cppo_CartPole-v1

Episode 44/50: Reward = 29.00, Steps = 29, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 100, Mod Rate = 0.0000, Viol Rate = 0.0876
Episode 45/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 101, Mod Rate = 0.0000, Viol Rate = 0.0874
Episode 46/50: Reward = 16.00, Steps = 16, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 101, Mod Rate = 0.0000, Viol Rate = 0.0862
Episode 47/50: Reward = 32.00, Steps = 32, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 103, Mod Rate = 0.0000, Viol Rate = 0.0855
Episode 48/50: Reward = 29.00, Steps = 29, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 109, Mod Rate = 0.0000, Viol Rate = 0.0884
Episode 49/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 110, Mod Rate = 0.0000, Viol Rate = 0.0882
Episode 50/50: Reward = 19.00, Steps = 19, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 113, Mod Rate = 0.0000, Viol Rate = 0.0893

Evaluation Summary:
Average Reward: 25.32
Standard Deviation: 17.13
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 113
Avg Constraint Violations per Step: 0.0893
Error tuning CPO: Should not reach.

================================================================================
Tuning: CMDP on CartPole-v1
Target reward: 150.0
Trials: 20
================================================================================

  0%|          | 0/20 [00:00<?, ?it/s]/opt/anaconda3/envs/thesis_env/lib/python3.11/site-packages/torch/nn/modules/loss.py:608: UserWarning: Using a target size (torch.Size([1])) that is different to the input size (torch.Size([])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x3475deb90>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3475ddcd0>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x347797e90>] [<pishield.propositional_requirements.constraint.Constraint object at 0x347797610>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x3477968d0>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 17.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 16, Viol Rate:  0.089
[Checkpoint] New best avg reward: 17.90 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 10.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 27, Viol Rate:  0.094
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 9.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 38, Viol Rate:  0.099
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 20.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 83, Viol Rate:  0.142
[Checkpoint] New best avg reward: 20.10 at episode 40
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 78.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 194, Viol Rate:  0.142
[Checkpoint] New best avg reward: 78.50 at episode 50
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 28.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 289, Viol Rate:  0.174
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 47.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 429, Viol Rate:  0.201
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 10.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 443, Viol Rate:  0.198
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 28.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 530, Viol Rate:  0.210
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 48.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 672, Viol Rate:  0.223
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 125.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 856, Viol Rate:  0.201
[Checkpoint] New best avg reward: 125.60 at episode 110
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 58.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 866, Viol Rate:  0.179
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 9.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 878, Viol Rate:  0.177
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 88.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 948, Viol Rate:  0.162
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 39.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 987, Viol Rate:  0.158
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 146.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1076, Viol Rate:  0.140
[Checkpoint] New best avg reward: 146.50 at episode 160
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 19.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1109, Viol Rate:  0.141
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 11.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1121, Viol Rate:  0.140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 57.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1265, Viol Rate:  0.147
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 74.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1386, Viol Rate:  0.149
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 14.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1401, Viol Rate:  0.148
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 14.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1424, Viol Rate:  0.148
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 22.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1456, Viol Rate:  0.148
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 30.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1508, Viol Rate:  0.149
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1517, Viol Rate:  0.148
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 10.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1524, Viol Rate:  0.147
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 35.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1580, Viol Rate:  0.148
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 50.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1601, Viol Rate:  0.143
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 11.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1608, Viol Rate:  0.142
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 12.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1616, Viol Rate:  0.141
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 9.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1628, Viol Rate:  0.141
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 11.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1639, Viol Rate:  0.140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1649, Viol Rate:  0.140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1663, Viol Rate:  0.140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1676, Viol Rate:  0.140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1689, Viol Rate:  0.140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1700, Viol Rate:  0.140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 10.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1716, Viol Rate:  0.140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 15.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1728, Viol Rate:  0.139
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 20.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1733, Viol Rate:  0.138
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 77.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1736, Viol Rate:  0.130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 177.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1761, Viol Rate:  0.116
[Checkpoint] New best avg reward: 177.60 at episode 420
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 64.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1871, Viol Rate:  0.118
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 9.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1877, Viol Rate:  0.118
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 10.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1880, Viol Rate:  0.117
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 51.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 2023, Viol Rate:  0.122
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 16.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 2047, Viol Rate:  0.123
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 2052, Viol Rate:  0.122
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 2058, Viol Rate:  0.122
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 2073, Viol Rate:  0.122

[Post-Training] Loading best weights with avg reward: 177.60

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 149.00, Steps = 149, Episode Modifications = 0, Episode Violations = 12, Total Modifications = 0, Total Violations = 12, Mod Rate = 0.0000, Viol Rate = 0.0805
Episode 2/50: Reward = 139.00, Steps = 139, Episode Modifications = 0, Episode Violations = 14, Total Modifications = 0, Total Violations = 26, Mod Rate = 0.0000, Viol Rate = 0.0903
Episode 3/50: Reward = 127.00, Steps = 127, Episode Modifications = 0, Episode Violations = 11, Total Modifications = 0, Total Violations = 37, Mod Rate = 0.0000, Viol Rate = 0.0892
Episode 4/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 37, Mod Rate = 0.0000, Viol Rate = 0.0867
Episode 5/50: Reward = 128.00, Steps = 128, Episode Modifications = 0, Episode Violations = 12, Total Modifications = 0, Total Violations = 49, Mod Rate = 0.0000, Viol Rate = 0.0883
Episode 6/50: Reward = 122.00, Steps = 122, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 59, Mod Rate = 0.0000, Viol Rate = 0.0871
Episode 7/50: Reward = 144.00, Steps = 144, Episode Modifications = 0, Episode Violations = 11, Total Modifications = 0, Total Violations = 70, Mod Rate = 0.0000, Viol Rate = 0.0853
Episode 8/50: Reward = 132.00, Steps = 132, Episode Modifications = 0, Episode Violations = 11, Total Modifications = 0, Total Violations = 81, Mod Rate = 0.0000, Viol Rate = 0.0850
Episode 9/50: Reward = 115.00, Steps = 115, Episode Modifications = 0, Episode Violations = 12, Total Modifications = 0, Total Violations = 93, Mod Rate = 0.0000, Viol Rate = 0.0871
Episode 10/50: Reward = 132.00, Steps = 132, Episode Modifications = 0, Episode Violations = 17, Total Modifications = 0, Total Violations = 110, Mod Rate = 0.0000, Viol Rate = 0.0917
Episode 11/50: Reward = 116.00, Steps = 116, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 118, Mod Rate = 0.0000, Viol Rate = 0.0897
Episode 12/50: Reward = 111.00, Steps = 111, Episode Modifications = 0, Episode Violations = 9, Total Modifications = 0, Total Violations = 127, Mod Rate = 0.0000, Viol Rate = 0.0890
Episode 13/50: Reward = 131.00, Steps = 131, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 133, Mod Rate = 0.0000, Viol Rate = 0.0854
Episode 14/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 133, Mod Rate = 0.0000, Viol Rate = 0.0848
Episode 15/50: Reward = 118.00, Steps = 118, Episode Modifications = 0, Episode Violations = 13, Total Modifications = 0, Total Violations = 146, Mod Rate = 0.0000, Viol Rate = 0.0866
Episode 16/50: Reward = 119.00, Steps = 119, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 151, Mod Rate = 0.0000, Viol Rate = 0.0837
Episode 17/50: Reward = 103.00, Steps = 103, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 154, Mod Rate = 0.0000, Viol Rate = 0.0807
Episode 18/50: Reward = 127.00, Steps = 127, Episode Modifications = 0, Episode Violations = 12, Total Modifications = 0, Total Violations = 166, Mod Rate = 0.0000, Viol Rate = 0.0816
Episode 19/50: Reward = 125.00, Steps = 125, Episode Modifications = 0, Episode Violations = 11, Total Modifications = 0, Total Violations = 177, Mod Rate = 0.0000, Viol Rate = 0.0819
Episode 20/50: Reward = 123.00, Steps = 123, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 182, Mod Rate = 0.0000, Viol Rate = 0.0797
Episode 21/50: Reward = 131.00, Steps = 131, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 190, Mod Rate = 0.0000, Viol Rate = 0.0787
Episode 22/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 190, Mod Rate = 0.0000, Viol Rate = 0.0784
Episode 23/50: Reward = 124.00, Steps = 124, Episode Modifications = 0, Episode Violations = 11, Total Modifications = 0, Total Violations = 201, Mod Rate = 0.0000, Viol Rate = 0.0789
Episode 24/50: Reward = 108.00, Steps = 108, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 211, Mod Rate = 0.0000, Viol Rate = 0.0794
Episode 25/50: Reward = 122.00, Steps = 122, Episode Modifications = 0, Episode Violations = 18, Total Modifications = 0, Total Violations = 229, Mod Rate = 0.0000, Viol Rate = 0.0824
Episode 26/50: Reward = 111.00, Steps = 111, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 237, Mod Rate = 0.0000, Viol Rate = 0.0820
Episode 27/50: Reward = 123.00, Steps = 123, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 247, Mod Rate = 0.0000, Viol Rate = 0.0820
Episode 28/50: Reward = 138.00, Steps = 138, Episode Modifications = 0, Episode Violations = 12, Total Modifications = 0, Total Violations = 259, Mod Rate = 0.0000, Viol Rate = 0.0822
Episode 29/50: Reward = 136.00, Steps = 136, Episode Modifications = 0, Episode Violations = 17, Total Modifications = 0, Total Violations = 276, Mod Rate = 0.0000, Viol Rate = 0.0840
Episode 30/50: Reward = 121.00, Steps = 121, Episode Modifications = 0, Episode Violations = 14, Total Modifications = 0, Total Violations = 290, Mod Rate = 0.0000, Viol Rate = 0.0851
Episode 31/50: Reward = 144.00, Steps = 144, Episode Modifications = 0, Episode Violations = 17, Total Modifications = 0, Total Violations = 307, Mod Rate = 0.0000, Viol Rate = 0.0864
Episode 32/50: Reward = 113.00, Steps = 113, Episode Modifications = 0, Episode Violations = 9, Total Modifications = 0, Total Violations = 316, Mod Rate = 0.0000, Viol Rate = 0.0862
Episode 33/50: Reward = 157.00, Steps = 157, Episode Modifications = 0, Episode Violations = 18, Total Modifications = 0, Total Violations = 334, Mod Rate = 0.0000, Viol Rate = 0.0874
Episode 34/50: Reward = 131.00, Steps = 131, Episode Modifications = 0, Episode Violations = 13, Total Modifications = 0, Total Violations = 347, Mod Rate = 0.0000, Viol Rate = 0.0878
Episode 35/50: Reward = 140.00, Steps = 140, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 354, Mod Rate = 0.0000, Viol Rate = 0.0865                                        0%|          | 0/20 [01:48<?, ?it/s]Best trial: 0. Best value: -0.229067:   0%|          | 0/20 [01:48<?, ?it/s]Best trial: 0. Best value: -0.229067:   5%|▌         | 1/20 [01:48<34:23, 108.63s/it]
Episode 36/50: Reward = 133.00, Steps = 133, Episode Modifications = 0, Episode Violations = 11, Total Modifications = 0, Total Violations = 365, Mod Rate = 0.0000, Viol Rate = 0.0864
Episode 37/50: Reward = 131.00, Steps = 131, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 370, Mod Rate = 0.0000, Viol Rate = 0.0849
Episode 38/50: Reward = 115.00, Steps = 115, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 373, Mod Rate = 0.0000, Viol Rate = 0.0834
Episode 39/50: Reward = 111.00, Steps = 111, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 383, Mod Rate = 0.0000, Viol Rate = 0.0836
Episode 40/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 383, Mod Rate = 0.0000, Viol Rate = 0.0833
Episode 41/50: Reward = 128.00, Steps = 128, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 393, Mod Rate = 0.0000, Viol Rate = 0.0832
Episode 42/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 393, Mod Rate = 0.0000, Viol Rate = 0.0830
Episode 43/50: Reward = 134.00, Steps = 134, Episode Modifications = 0, Episode Violations = 19, Total Modifications = 0, Total Violations = 412, Mod Rate = 0.0000, Viol Rate = 0.0846
Episode 44/50: Reward = 131.00, Steps = 131, Episode Modifications = 0, Episode Violations = 18, Total Modifications = 0, Total Violations = 430, Mod Rate = 0.0000, Viol Rate = 0.0860
Episode 45/50: Reward = 130.00, Steps = 130, Episode Modifications = 0, Episode Violations = 14, Total Modifications = 0, Total Violations = 444, Mod Rate = 0.0000, Viol Rate = 0.0865
Episode 46/50: Reward = 136.00, Steps = 136, Episode Modifications = 0, Episode Violations = 13, Total Modifications = 0, Total Violations = 457, Mod Rate = 0.0000, Viol Rate = 0.0868
Episode 47/50: Reward = 134.00, Steps = 134, Episode Modifications = 0, Episode Violations = 12, Total Modifications = 0, Total Violations = 469, Mod Rate = 0.0000, Viol Rate = 0.0868
Episode 48/50: Reward = 120.00, Steps = 120, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 479, Mod Rate = 0.0000, Viol Rate = 0.0868
Episode 49/50: Reward = 124.00, Steps = 124, Episode Modifications = 0, Episode Violations = 12, Total Modifications = 0, Total Violations = 491, Mod Rate = 0.0000, Viol Rate = 0.0870
Episode 50/50: Reward = 137.00, Steps = 137, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 501, Mod Rate = 0.0000, Viol Rate = 0.0866

Evaluation Summary:
Average Reward: 115.64
Standard Deviation: 36.25
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 501
Avg Constraint Violations per Step: 0.0866
[I 2025-12-26 15:12:11,271] Trial 0 finished with value: -0.22906666513955556 and parameters: {'lr': 0.0008562359030077422, 'gamma': 0.9021451856983671, 'hidden_dim': 256, 'use_orthogonal_init': True, 'num_layers': 2, 'cost_gamma': 0.9713458665509909, 'cost_lam': 0.9971303806568022, 'clip_eps': 0.23278109309000553, 'ent_coef': 0.022530485036227055, 'epochs': 5, 'batch_size': 64, 'budget': 0.2619573131578563, 'nu_lr': 0.00020029261850739227}. Best is trial 0 with value: -0.22906666513955556.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x347999910>] [<pishield.propositional_requirements.constraint.Constraint object at 0x358413010>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x3583f1210>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3582aded0>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x358421890>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 12.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 11, Viol Rate:  0.091
[Checkpoint] New best avg reward: 12.10 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 24, Viol Rate:  0.111
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 36, Viol Rate:  0.116
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 46, Viol Rate:  0.114
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 8.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 56, Viol Rate:  0.114
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 67, Viol Rate:  0.115
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 80, Viol Rate:  0.118
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 94, Viol Rate:  0.122
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 105, Viol Rate:  0.121
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 115, Viol Rate:  0.120
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 129, Viol Rate:  0.122
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 142, Viol Rate:  0.124
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 152, Viol Rate:  0.122
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 163, Viol Rate:  0.122
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 9.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 175, Viol Rate:  0.123
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 187, Viol Rate:  0.123
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 202, Viol Rate:  0.125
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 212, Viol Rate:  0.124
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 225, Viol Rate:  0.125
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 238, Viol Rate:  0.126
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 252, Viol Rate:  0.127
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 268, Viol Rate:  0.129
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 282, Viol Rate:  0.129
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 8.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 296, Viol Rate:  0.131
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 306, Viol Rate:  0.130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 318, Viol Rate:  0.130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 9.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 331, Viol Rate:  0.130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 343, Viol Rate:  0.130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 11.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 358, Viol Rate:  0.130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 370, Viol Rate:  0.130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 10.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 382, Viol Rate:  0.129
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 54.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 474, Viol Rate:  0.136
[Checkpoint] New best avg reward: 54.20 at episode 320
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 69.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 578, Viol Rate:  0.138
[Checkpoint] New best avg reward: 69.00 at episode 330
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 61.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 646, Viol Rate:  0.135
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 135.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 675, Viol Rate:  0.110
[Checkpoint] New best avg reward: 135.40 at episode 350
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 686, Viol Rate:  0.110
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 700, Viol Rate:  0.110
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 713, Viol Rate:  0.111
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 8.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 728, Viol Rate:  0.111
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 24.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 736, Viol Rate:  0.109
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 739, Viol Rate:  0.107
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 148.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 750, Viol Rate:  0.090
[Checkpoint] New best avg reward: 148.90 at episode 420
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 202.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 826, Viol Rate:  0.079
[Checkpoint] New best avg reward: 202.60 at episode 430
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 93.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 836, Viol Rate:  0.074
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 245.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 848, Viol Rate:  0.062
[Checkpoint] New best avg reward: 245.10 at episode 450
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 21.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 876, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 153.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 890, Viol Rate:  0.057
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 66.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 890, Viol Rate:  0.055
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 34.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 895, Viol Rate:  0.054
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 10.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 898, Viol Rate:  0.054

[Post-Training] Loading best weights with avg reward: 245.10

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 2/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 3/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 4/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0222
Episode 5/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0182
Episode 6/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0152
Episode 7/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0127
Episode 8/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0111
Episode 9/50: Reward = 100.00, Steps = 100, Episode Modifications = 0, Episode Violations = 19, Total Modifications = 0, Total Violations = 20, Mod Rate = 0.0000, Viol Rate = 0.1053
Episode 10/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 20, Mod Rate = 0.0000, Viol Rate = 0.0995
Episode 11/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 21, Mod Rate = 0.0000, Viol Rate = 0.0986
Episode 12/50: Reward = 29.00, Steps = 29, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 29, Mod Rate = 0.0000, Viol Rate = 0.1198
Episode 13/50: Reward = 105.00, Steps = 105, Episode Modifications = 0, Episode Violations = 20, Total Modifications = 0, Total Violations = 49, Mod Rate = 0.0000, Viol Rate = 0.1412
Episode 14/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 49, Mod Rate = 0.0000, Viol Rate = 0.1369
Episode 15/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.1355
Episode 16/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 51, Mod Rate = 0.0000, Viol Rate = 0.1342                                                                                     Best trial: 0. Best value: -0.229067:   5%|▌         | 1/20 [03:23<34:23, 108.63s/it]Best trial: 0. Best value: -0.229067:   5%|▌         | 1/20 [03:23<34:23, 108.63s/it]Best trial: 0. Best value: -0.229067:  10%|█         | 2/20 [03:23<30:10, 100.59s/it]
Episode 17/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 51, Mod Rate = 0.0000, Viol Rate = 0.1304
Episode 18/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 52, Mod Rate = 0.0000, Viol Rate = 0.1290
Episode 19/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 54, Mod Rate = 0.0000, Viol Rate = 0.1304
Episode 20/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 55, Mod Rate = 0.0000, Viol Rate = 0.1291
Episode 21/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 55, Mod Rate = 0.0000, Viol Rate = 0.1261
Episode 22/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 55, Mod Rate = 0.0000, Viol Rate = 0.1233
Episode 23/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 55, Mod Rate = 0.0000, Viol Rate = 0.1206
Episode 24/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 56, Mod Rate = 0.0000, Viol Rate = 0.1202
Episode 25/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 56, Mod Rate = 0.0000, Viol Rate = 0.1172
Episode 26/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 58, Mod Rate = 0.0000, Viol Rate = 0.1184
Episode 27/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 60, Mod Rate = 0.0000, Viol Rate = 0.1193
Episode 28/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 60, Mod Rate = 0.0000, Viol Rate = 0.1170
Episode 29/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 60, Mod Rate = 0.0000, Viol Rate = 0.1147
Episode 30/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 61, Mod Rate = 0.0000, Viol Rate = 0.1140
Episode 31/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 61, Mod Rate = 0.0000, Viol Rate = 0.1115
Episode 32/50: Reward = 103.00, Steps = 103, Episode Modifications = 0, Episode Violations = 18, Total Modifications = 0, Total Violations = 79, Mod Rate = 0.0000, Viol Rate = 0.1215
Episode 33/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 80, Mod Rate = 0.0000, Viol Rate = 0.1208
Episode 34/50: Reward = 99.00, Steps = 99, Episode Modifications = 0, Episode Violations = 18, Total Modifications = 0, Total Violations = 98, Mod Rate = 0.0000, Viol Rate = 0.1288
Episode 35/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 98, Mod Rate = 0.0000, Viol Rate = 0.1268
Episode 36/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 98, Mod Rate = 0.0000, Viol Rate = 0.1250
Episode 37/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 98, Mod Rate = 0.0000, Viol Rate = 0.1233
Episode 38/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 98, Mod Rate = 0.0000, Viol Rate = 0.1219
Episode 39/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 101, Mod Rate = 0.0000, Viol Rate = 0.1238
Episode 40/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 102, Mod Rate = 0.0000, Viol Rate = 0.1230
Episode 41/50: Reward = 103.00, Steps = 103, Episode Modifications = 0, Episode Violations = 19, Total Modifications = 0, Total Violations = 121, Mod Rate = 0.0000, Viol Rate = 0.1298
Episode 42/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 121, Mod Rate = 0.0000, Viol Rate = 0.1282
Episode 43/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 123, Mod Rate = 0.0000, Viol Rate = 0.1288
Episode 44/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 127, Mod Rate = 0.0000, Viol Rate = 0.1315
Episode 45/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 127, Mod Rate = 0.0000, Viol Rate = 0.1301
Episode 46/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 127, Mod Rate = 0.0000, Viol Rate = 0.1287
Episode 47/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 129, Mod Rate = 0.0000, Viol Rate = 0.1290
Episode 48/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 131, Mod Rate = 0.0000, Viol Rate = 0.1296
Episode 49/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 131, Mod Rate = 0.0000, Viol Rate = 0.1282
Episode 50/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 131, Mod Rate = 0.0000, Viol Rate = 0.1268

Evaluation Summary:
Average Reward: 20.66
Standard Deviation: 27.25
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 131
Avg Constraint Violations per Step: 0.1268
[I 2025-12-26 15:13:46,237] Trial 1 finished with value: -0.8622666609182223 and parameters: {'lr': 0.004930343236588886, 'gamma': 0.964201762509399, 'hidden_dim': 128, 'use_orthogonal_init': False, 'num_layers': 3, 'cost_gamma': 0.9322291133404392, 'cost_lam': 0.963290898017336, 'clip_eps': 0.1601361598069378, 'ent_coef': 0.02019182155310047, 'epochs': 8, 'batch_size': 64, 'budget': 0.08226850998481426, 'nu_lr': 0.001505698701144883}. Best is trial 0 with value: -0.22906666513955556.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x3694dd0d0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3694f7890>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x3695270d0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3695257d0>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x36953a950>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 27.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 19, Viol Rate:  0.069
[Checkpoint] New best avg reward: 27.60 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 32.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 48, Viol Rate:  0.080
[Checkpoint] New best avg reward: 32.30 at episode 20
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 31.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 73, Viol Rate:  0.080
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 24.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 87, Viol Rate:  0.075
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 25.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 107, Viol Rate:  0.076
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 51.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 163, Viol Rate:  0.085
[Checkpoint] New best avg reward: 51.90 at episode 60
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 55.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 230, Viol Rate:  0.093
[Checkpoint] New best avg reward: 55.10 at episode 70
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 164.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 364, Viol Rate:  0.088
[Checkpoint] New best avg reward: 164.20 at episode 80
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 35.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 469, Viol Rate:  0.105
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 112.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 562, Viol Rate:  0.101
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 574, Viol Rate:  0.101
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 587, Viol Rate:  0.102
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 603, Viol Rate:  0.103
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 616, Viol Rate:  0.103
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 630, Viol Rate:  0.104
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 644, Viol Rate:  0.105
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 656, Viol Rate:  0.105
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 667, Viol Rate:  0.105
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 681, Viol Rate:  0.106
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 695, Viol Rate:  0.106
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 710, Viol Rate:  0.107
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 723, Viol Rate:  0.108
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 734, Viol Rate:  0.108
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 745, Viol Rate:  0.108
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 8.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 756, Viol Rate:  0.108
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 767, Viol Rate:  0.108
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 777, Viol Rate:  0.108
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 791, Viol Rate:  0.109
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 804, Viol Rate:  0.109
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 818, Viol Rate:  0.110
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 831, Viol Rate:  0.110
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 841, Viol Rate:  0.110
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 853, Viol Rate:  0.110
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 867, Viol Rate:  0.111
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 881, Viol Rate:  0.111
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 893, Viol Rate:  0.111
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 905, Viol Rate:  0.111
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 918, Viol Rate:  0.112
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 8.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 929, Viol Rate:  0.112
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 942, Viol Rate:  0.112
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 954, Viol Rate:  0.112
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 966, Viol Rate:  0.112
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 982, Viol Rate:  0.113
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 994, Viol Rate:  0.113
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1006, Viol Rate:  0.113
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1018, Viol Rate:  0.114
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1030, Viol Rate:  0.114
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1041, Viol Rate:  0.114
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1053, Viol Rate:  0.114
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1063, Viol Rate:  0.114

[Post-Training] Loading best weights with avg reward: 164.20

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 2/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 3, Mod Rate = 0.0000, Viol Rate = 0.1154
Episode 3/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.1707
Episode 4/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.1346
Episode 5/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.1148
Episode 6/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.1127
Episode 7/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 11, Mod Rate = 0.0000, Viol Rate = 0.1341
Episode 8/50: Reward = 32.00, Steps = 32, Episode Modifications = 0, Episode Violations = 9, Total Modifications = 0, Total Violations = 20, Mod Rate = 0.0000, Viol Rate = 0.1754
Episode 9/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 22, Mod Rate = 0.0000, Viol Rate = 0.1732
Episode 10/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 23, Mod Rate = 0.0000, Viol Rate = 0.1679
Episode 11/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 24, Mod Rate = 0.0000, Viol Rate = 0.1611
Episode 12/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 24, Mod Rate = 0.0000, Viol Rate = 0.1491
Episode 13/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 26, Mod Rate = 0.0000, Viol Rate = 0.1486
Episode 14/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 28, Mod Rate = 0.0000, Viol Rate = 0.1489
Episode 15/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 29, Mod Rate = 0.0000, Viol Rate = 0.1443
Episode 16/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 32, Mod Rate = 0.0000, Viol Rate = 0.1495
Episode 17/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 36, Mod Rate = 0.0000, Viol Rate = 0.1572
Episode 18/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.1618
Episode 19/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.1554
Episode 20/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.1489
Episode 21/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.1434
Episode 22/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 40, Mod Rate = 0.0000, Viol Rate = 0.1413
Episode 23/50: Reward = 53.00, Steps = 53, Episode Modifications = 0, Episode Violations = 20, Total Modifications = 0, Total Violations = 60, Mod Rate = 0.0000, Viol Rate = 0.1786
Episode 24/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.1787
Episode 25/50: Reward = 65.00, Steps = 65, Episode Modifications = 0, Episode Violations = 27, Total Modifications = 0, Total Violations = 89, Mod Rate = 0.0000, Viol Rate = 0.2160
Episode 26/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 90, Mod Rate = 0.0000, Viol Rate = 0.2123
Episode 27/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 90, Mod Rate = 0.0000, Viol Rate = 0.2064
Episode 28/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 92, Mod Rate = 0.0000, Viol Rate = 0.2049
Episode 29/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 93, Mod Rate = 0.0000, Viol Rate = 0.2022
Episode 30/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 96, Mod Rate = 0.0000, Viol Rate = 0.2025
Episode 31/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 96, Mod Rate = 0.0000, Viol Rate = 0.1975
Episode 32/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 97, Mod Rate = 0.0000, Viol Rate = 0.1948
Episode 33/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 101, Mod Rate = 0.0000, Viol Rate = 0.1973
Episode 34/50: Reward = 83.00, Steps = 83, Episode Modifications = 0, Episode Violations = 33, Total Modifications = 0, Total Violations = 134, Mod Rate = 0.0000, Viol Rate = 0.2252
Episode 35/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 134, Mod Rate = 0.0000, Viol Rate = 0.2211
Episode 36/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 134, Mod Rate = 0.0000, Viol Rate = 0.2161
Episode 37/50: Reward = 64.00, Steps = 64, Episode Modifications = 0, Episode Violations = 23, Total Modifications = 0, Total Violations = 157, Mod Rate = 0.0000, Viol Rate = 0.2295
Episode 38/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 158, Mod Rate = 0.0000, Viol Rate = 0.2277
Episode 39/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 159, Mod Rate = 0.0000, Viol Rate = 0.2243
Episode 40/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 160, Mod Rate = 0.0000, Viol Rate = 0.2225
Episode 41/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 160, Mod Rate = 0.0000, Viol Rate = 0.2183
Episode 42/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 160, Mod Rate = 0.0000, Viol Rate = 0.2151
Episode 43/50: Reward = 34.00, Steps = 34, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 170, Mod Rate = 0.0000, Viol Rate = 0.2185
Episode 44/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 170, Mod Rate = 0.0000, Viol Rate = 0.2157                                                                                     Best trial: 0. Best value: -0.229067:  10%|█         | 2/20 [04:47<30:10, 100.59s/it]Best trial: 0. Best value: -0.229067:  10%|█         | 2/20 [04:47<30:10, 100.59s/it]Best trial: 0. Best value: -0.229067:  15%|█▌        | 3/20 [04:47<26:23, 93.12s/it] 
Episode 45/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 171, Mod Rate = 0.0000, Viol Rate = 0.2135
Episode 46/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 171, Mod Rate = 0.0000, Viol Rate = 0.2111
Episode 47/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 175, Mod Rate = 0.0000, Viol Rate = 0.2132
Episode 48/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 179, Mod Rate = 0.0000, Viol Rate = 0.2141
Episode 49/50: Reward = 59.00, Steps = 59, Episode Modifications = 0, Episode Violations = 22, Total Modifications = 0, Total Violations = 201, Mod Rate = 0.0000, Viol Rate = 0.2246
Episode 50/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 202, Mod Rate = 0.0000, Viol Rate = 0.2227

Evaluation Summary:
Average Reward: 18.14
Standard Deviation: 16.47
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 202
Avg Constraint Violations per Step: 0.2227
[I 2025-12-26 15:15:10,463] Trial 2 finished with value: -0.8790666608062224 and parameters: {'lr': 0.000557072247056944, 'gamma': 0.9402669220705197, 'hidden_dim': 256, 'use_orthogonal_init': True, 'num_layers': 4, 'cost_gamma': 0.934032964859444, 'cost_lam': 0.9097900952948852, 'clip_eps': 0.10406023497491233, 'ent_coef': 0.033114474510657306, 'epochs': 3, 'batch_size': 64, 'budget': 0.06535024518073164, 'nu_lr': 0.00019039659460814556}. Best is trial 0 with value: -0.22906666513955556.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x3693137d0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3583c8ad0>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x35837ffd0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x35dfb5010>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x36a58ec90>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 26.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 21, Viol Rate:  0.080
[Checkpoint] New best avg reward: 26.40 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 26.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 52, Viol Rate:  0.099
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 28.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 75, Viol Rate:  0.092
[Checkpoint] New best avg reward: 28.90 at episode 30
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 12.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 88, Viol Rate:  0.093
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 36.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 126, Viol Rate:  0.096
[Checkpoint] New best avg reward: 36.80 at episode 50
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 44.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 154, Viol Rate:  0.088
[Checkpoint] New best avg reward: 44.30 at episode 60
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 39.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 187, Viol Rate:  0.087
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 34.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 213, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 22.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 229, Viol Rate:  0.084
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 37.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 250, Viol Rate:  0.081
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 24.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 270, Viol Rate:  0.081
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 28.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 299, Viol Rate:  0.083
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 34.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 336, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 13.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 347, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 12.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 367, Viol Rate:  0.087
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 10.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 380, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 21.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 416, Viol Rate:  0.092
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 42.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 464, Viol Rate:  0.093
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 24.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 485, Viol Rate:  0.093
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 23.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 506, Viol Rate:  0.093
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 23.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 522, Viol Rate:  0.092
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 21.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 530, Viol Rate:  0.090
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 17.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 543, Viol Rate:  0.089
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 54.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 572, Viol Rate:  0.086
[Checkpoint] New best avg reward: 54.90 at episode 240
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 69.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 601, Viol Rate:  0.082
[Checkpoint] New best avg reward: 69.80 at episode 250
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 27.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 621, Viol Rate:  0.082
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 634, Viol Rate:  0.082
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 9.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 649, Viol Rate:  0.083
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 660, Viol Rate:  0.084
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 672, Viol Rate:  0.084
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 684, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 695, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 707, Viol Rate:  0.086
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 721, Viol Rate:  0.086
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 734, Viol Rate:  0.087
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 747, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 759, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 770, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 783, Viol Rate:  0.089
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 9.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 795, Viol Rate:  0.089
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 808, Viol Rate:  0.090
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 820, Viol Rate:  0.090
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 833, Viol Rate:  0.091
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 844, Viol Rate:  0.091
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 855, Viol Rate:  0.091
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 868, Viol Rate:  0.092
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 881, Viol Rate:  0.092
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 894, Viol Rate:  0.093
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 905, Viol Rate:  0.093
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 917, Viol Rate:  0.093

[Post-Training] Loading best weights with avg reward: 69.80

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 147.00, Steps = 147, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0068
Episode 2/50: Reward = 168.00, Steps = 168, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 2, Mod Rate = 0.0000, Viol Rate = 0.0063
Episode 3/50: Reward = 96.00, Steps = 96, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 5, Mod Rate = 0.0000, Viol Rate = 0.0122
Episode 4/50: Reward = 235.00, Steps = 235, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0108
Episode 5/50: Reward = 36.00, Steps = 36, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0117
Episode 6/50: Reward = 125.00, Steps = 125, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 13, Mod Rate = 0.0000, Viol Rate = 0.0161
Episode 7/50: Reward = 85.00, Steps = 85, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 14, Mod Rate = 0.0000, Viol Rate = 0.0157
Episode 8/50: Reward = 158.00, Steps = 158, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 17, Mod Rate = 0.0000, Viol Rate = 0.0162
Episode 9/50: Reward = 160.00, Steps = 160, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 17, Mod Rate = 0.0000, Viol Rate = 0.0140
Episode 10/50: Reward = 127.00, Steps = 127, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 18, Mod Rate = 0.0000, Viol Rate = 0.0135
Episode 11/50: Reward = 142.00, Steps = 142, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 18, Mod Rate = 0.0000, Viol Rate = 0.0122
Episode 12/50: Reward = 47.00, Steps = 47, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 18, Mod Rate = 0.0000, Viol Rate = 0.0118
Episode 13/50: Reward = 83.00, Steps = 83, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 25, Mod Rate = 0.0000, Viol Rate = 0.0155
Episode 14/50: Reward = 40.00, Steps = 40, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 26, Mod Rate = 0.0000, Viol Rate = 0.0158
Episode 15/50: Reward = 188.00, Steps = 188, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 29, Mod Rate = 0.0000, Viol Rate = 0.0158
Episode 16/50: Reward = 52.00, Steps = 52, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 30, Mod Rate = 0.0000, Viol Rate = 0.0159
Episode 17/50: Reward = 50.00, Steps = 50, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.0160
Episode 18/50: Reward = 27.00, Steps = 27, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 32, Mod Rate = 0.0000, Viol Rate = 0.0163
Episode 19/50: Reward = 48.00, Steps = 48, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 33, Mod Rate = 0.0000, Viol Rate = 0.0164
Episode 20/50: Reward = 225.00, Steps = 225, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 34, Mod Rate = 0.0000, Viol Rate = 0.0152
Episode 21/50: Reward = 199.00, Steps = 199, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 38, Mod Rate = 0.0000, Viol Rate = 0.0156
Episode 22/50: Reward = 126.00, Steps = 126, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.0152
Episode 23/50: Reward = 33.00, Steps = 33, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 40, Mod Rate = 0.0000, Viol Rate = 0.0154
Episode 24/50: Reward = 125.00, Steps = 125, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 43, Mod Rate = 0.0000, Viol Rate = 0.0158
Episode 25/50: Reward = 112.00, Steps = 112, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 44, Mod Rate = 0.0000, Viol Rate = 0.0155                                                                                    Best trial: 0. Best value: -0.229067:  15%|█▌        | 3/20 [06:03<26:23, 93.12s/it]Best trial: 0. Best value: -0.229067:  15%|█▌        | 3/20 [06:03<26:23, 93.12s/it]Best trial: 0. Best value: -0.229067:  20%|██        | 4/20 [06:03<22:56, 86.04s/it]
Episode 26/50: Reward = 26.00, Steps = 26, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 44, Mod Rate = 0.0000, Viol Rate = 0.0154
Episode 27/50: Reward = 56.00, Steps = 56, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 45, Mod Rate = 0.0000, Viol Rate = 0.0154
Episode 28/50: Reward = 265.00, Steps = 265, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.0157
Episode 29/50: Reward = 56.00, Steps = 56, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.0154
Episode 30/50: Reward = 116.00, Steps = 116, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.0149
Episode 31/50: Reward = 42.00, Steps = 42, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.0147
Episode 32/50: Reward = 85.00, Steps = 85, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 51, Mod Rate = 0.0000, Viol Rate = 0.0147
Episode 33/50: Reward = 95.00, Steps = 95, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 51, Mod Rate = 0.0000, Viol Rate = 0.0143
Episode 34/50: Reward = 143.00, Steps = 143, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 52, Mod Rate = 0.0000, Viol Rate = 0.0140
Episode 35/50: Reward = 81.00, Steps = 81, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 52, Mod Rate = 0.0000, Viol Rate = 0.0137
Episode 36/50: Reward = 147.00, Steps = 147, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 60, Mod Rate = 0.0000, Viol Rate = 0.0152
Episode 37/50: Reward = 50.00, Steps = 50, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 60, Mod Rate = 0.0000, Viol Rate = 0.0150
Episode 38/50: Reward = 35.00, Steps = 35, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 60, Mod Rate = 0.0000, Viol Rate = 0.0149
Episode 39/50: Reward = 194.00, Steps = 194, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 61, Mod Rate = 0.0000, Viol Rate = 0.0144
Episode 40/50: Reward = 24.00, Steps = 24, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 61, Mod Rate = 0.0000, Viol Rate = 0.0144
Episode 41/50: Reward = 106.00, Steps = 106, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0142
Episode 42/50: Reward = 46.00, Steps = 46, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0141
Episode 43/50: Reward = 43.00, Steps = 43, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 63, Mod Rate = 0.0000, Viol Rate = 0.0142
Episode 44/50: Reward = 58.00, Steps = 58, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 64, Mod Rate = 0.0000, Viol Rate = 0.0142
Episode 45/50: Reward = 184.00, Steps = 184, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 66, Mod Rate = 0.0000, Viol Rate = 0.0141
Episode 46/50: Reward = 30.00, Steps = 30, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 67, Mod Rate = 0.0000, Viol Rate = 0.0142
Episode 47/50: Reward = 75.00, Steps = 75, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 67, Mod Rate = 0.0000, Viol Rate = 0.0140
Episode 48/50: Reward = 107.00, Steps = 107, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 72, Mod Rate = 0.0000, Viol Rate = 0.0147
Episode 49/50: Reward = 43.00, Steps = 43, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 72, Mod Rate = 0.0000, Viol Rate = 0.0146
Episode 50/50: Reward = 104.00, Steps = 104, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 74, Mod Rate = 0.0000, Viol Rate = 0.0147

Evaluation Summary:
Average Reward: 100.90
Standard Deviation: 61.34
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 74
Avg Constraint Violations per Step: 0.0147
[I 2025-12-26 15:16:25,659] Trial 3 finished with value: -0.3273333311511111 and parameters: {'lr': 0.0006516888616720864, 'gamma': 0.9125940714021329, 'hidden_dim': 512, 'use_orthogonal_init': True, 'num_layers': 4, 'cost_gamma': 0.9321831578123181, 'cost_lam': 0.983495580596218, 'clip_eps': 0.2643829495042139, 'ent_coef': 0.035841443187862906, 'epochs': 3, 'batch_size': 128, 'budget': 0.09909937999469577, 'nu_lr': 0.001017566106118711}. Best is trial 0 with value: -0.22906666513955556.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x37c6d2210>] [<pishield.propositional_requirements.constraint.Constraint object at 0x37ac68610>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x3835b0590>] [<pishield.propositional_requirements.constraint.Constraint object at 0x373b29890>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x3835df410>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 31.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 37, Viol Rate:  0.117
[Checkpoint] New best avg reward: 31.60 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 38.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 65, Viol Rate:  0.093
[Checkpoint] New best avg reward: 38.40 at episode 20
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 43.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 101, Viol Rate:  0.089
[Checkpoint] New best avg reward: 43.80 at episode 30
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 33.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 129, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 44.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 170, Viol Rate:  0.089
[Checkpoint] New best avg reward: 44.70 at episode 50
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 49.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 199, Viol Rate:  0.083
[Checkpoint] New best avg reward: 49.20 at episode 60
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 28.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 215, Viol Rate:  0.080
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 16.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 227, Viol Rate:  0.079
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 42.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 263, Viol Rate:  0.080
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 40.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 286, Viol Rate:  0.078
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 47.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 315, Viol Rate:  0.076
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 48.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 356, Viol Rate:  0.077
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 51.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 384, Viol Rate:  0.075
[Checkpoint] New best avg reward: 51.10 at episode 130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 49.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 424, Viol Rate:  0.075
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 41.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 455, Viol Rate:  0.075
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 40.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 492, Viol Rate:  0.076
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 34.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 514, Viol Rate:  0.076
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 57.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 565, Viol Rate:  0.077
[Checkpoint] New best avg reward: 57.80 at episode 180
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 64.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 611, Viol Rate:  0.076
[Checkpoint] New best avg reward: 64.30 at episode 190
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 60.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 639, Viol Rate:  0.074
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 73.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 706, Viol Rate:  0.075
[Checkpoint] New best avg reward: 73.20 at episode 210
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 56.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 737, Viol Rate:  0.074
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 30.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 751, Viol Rate:  0.073
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 26.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 764, Viol Rate:  0.073
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 26.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 790, Viol Rate:  0.073
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 24.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 809, Viol Rate:  0.074
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 22.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 822, Viol Rate:  0.073
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 73.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 874, Viol Rate:  0.073
[Checkpoint] New best avg reward: 73.40 at episode 280
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 116.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 922, Viol Rate:  0.070
[Checkpoint] New best avg reward: 116.90 at episode 290
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 110.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 977, Viol Rate:  0.069
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 148.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1061, Viol Rate:  0.068
[Checkpoint] New best avg reward: 148.70 at episode 310
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 62.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1115, Viol Rate:  0.068
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 62.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1169, Viol Rate:  0.069
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 117.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1215, Viol Rate:  0.067
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 59.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1247, Viol Rate:  0.067
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 25.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1255, Viol Rate:  0.066
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 43.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1275, Viol Rate:  0.066
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 138.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1325, Viol Rate:  0.064
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 148.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1396, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 202.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1450, Viol Rate:  0.060
[Checkpoint] New best avg reward: 202.40 at episode 400
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 164.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1503, Viol Rate:  0.058
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 119.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1533, Viol Rate:  0.056
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 120.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1564, Viol Rate:  0.055
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 62.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1588, Viol Rate:  0.055
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 85.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1607, Viol Rate:  0.054
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 90.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1649, Viol Rate:  0.054
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 25.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1657, Viol Rate:  0.053
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 25.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1664, Viol Rate:  0.053
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 25.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1674, Viol Rate:  0.053
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 41.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1684, Viol Rate:  0.053

[Post-Training] Loading best weights with avg reward: 202.40

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 117.00, Steps = 117, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 5, Mod Rate = 0.0000, Viol Rate = 0.0427
Episode 2/50: Reward = 129.00, Steps = 129, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0285
Episode 3/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0272
Episode 4/50: Reward = 168.00, Steps = 168, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 17, Mod Rate = 0.0000, Viol Rate = 0.0400
Episode 5/50: Reward = 161.00, Steps = 161, Episode Modifications = 0, Episode Violations = 14, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.0529
Episode 6/50: Reward = 91.00, Steps = 91, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 34, Mod Rate = 0.0000, Viol Rate = 0.0502
Episode 7/50: Reward = 133.00, Steps = 133, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 36, Mod Rate = 0.0000, Viol Rate = 0.0444
Episode 8/50: Reward = 142.00, Steps = 142, Episode Modifications = 0, Episode Violations = 11, Total Modifications = 0, Total Violations = 47, Mod Rate = 0.0000, Viol Rate = 0.0494
Episode 9/50: Reward = 138.00, Steps = 138, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 47, Mod Rate = 0.0000, Viol Rate = 0.0431
Episode 10/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 47, Mod Rate = 0.0000, Viol Rate = 0.0426
Episode 11/50: Reward = 109.00, Steps = 109, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 55, Mod Rate = 0.0000, Viol Rate = 0.0453
Episode 12/50: Reward = 72.00, Steps = 72, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 56, Mod Rate = 0.0000, Viol Rate = 0.0436
Episode 13/50: Reward = 60.00, Steps = 60, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 57, Mod Rate = 0.0000, Viol Rate = 0.0424
Episode 14/50: Reward = 148.00, Steps = 148, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 61, Mod Rate = 0.0000, Viol Rate = 0.0409
Episode 15/50: Reward = 79.00, Steps = 79, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0394
Episode 16/50: Reward = 58.00, Steps = 58, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0380
Episode 17/50: Reward = 78.00, Steps = 78, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 65, Mod Rate = 0.0000, Viol Rate = 0.0381
Episode 18/50: Reward = 137.00, Steps = 137, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 69, Mod Rate = 0.0000, Viol Rate = 0.0374
Episode 19/50: Reward = 218.00, Steps = 218, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 77, Mod Rate = 0.0000, Viol Rate = 0.0373
Episode 20/50: Reward = 22.00, Steps = 22, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 77, Mod Rate = 0.0000, Viol Rate = 0.0369
Episode 21/50: Reward = 19.00, Steps = 19, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 77, Mod Rate = 0.0000, Viol Rate = 0.0366
Episode 22/50: Reward = 126.00, Steps = 126, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 77, Mod Rate = 0.0000, Viol Rate = 0.0345
Episode 23/50: Reward = 144.00, Steps = 144, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 87, Mod Rate = 0.0000, Viol Rate = 0.0366
Episode 24/50: Reward = 51.00, Steps = 51, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 87, Mod Rate = 0.0000, Viol Rate = 0.0359
Episode 25/50: Reward = 171.00, Steps = 171, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 92, Mod Rate = 0.0000, Viol Rate = 0.0354
Episode 26/50: Reward = 109.00, Steps = 109, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 96, Mod Rate = 0.0000, Viol Rate = 0.0355
Episode 27/50: Reward = 125.00, Steps = 125, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 104, Mod Rate = 0.0000, Viol Rate = 0.0367
Episode 28/50: Reward = 143.00, Steps = 143, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 111, Mod Rate = 0.0000, Viol Rate = 0.0373
Episode 29/50: Reward = 126.00, Steps = 126, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 115, Mod Rate = 0.0000, Viol Rate = 0.0371
Episode 30/50: Reward = 22.00, Steps = 22, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 116, Mod Rate = 0.0000, Viol Rate = 0.0372
Episode 31/50: Reward = 167.00, Steps = 167, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 117, Mod Rate = 0.0000, Viol Rate = 0.0356
Episode 32/50: Reward = 143.00, Steps = 143, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 117, Mod Rate = 0.0000, Viol Rate = 0.0341
Episode 33/50: Reward = 154.00, Steps = 154, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 119, Mod Rate = 0.0000, Viol Rate = 0.0332
Episode 34/50: Reward = 137.00, Steps = 137, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 124, Mod Rate = 0.0000, Viol Rate = 0.0333
Episode 35/50: Reward = 169.00, Steps = 169, Episode Modifications = 0, Episode Violations = 9, Total Modifications = 0, Total Violations = 133, Mod Rate = 0.0000, Viol Rate = 0.0342
Episode 36/50: Reward = 144.00, Steps = 144, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 136, Mod Rate = 0.0000, Viol Rate = 0.0337
Episode 37/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 137, Mod Rate = 0.0000, Viol Rate = 0.0338
Episode 38/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 137, Mod Rate = 0.0000, Viol Rate = 0.0337
Episode 39/50: Reward = 113.00, Steps = 113, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 137, Mod Rate = 0.0000, Viol Rate = 0.0328
Episode 40/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 137, Mod Rate = 0.0000, Viol Rate = 0.0327
Episode 41/50: Reward = 17.00, Steps = 17, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 138, Mod Rate = 0.0000, Viol Rate = 0.0328
Episode 42/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 138, Mod Rate = 0.0000, Viol Rate = 0.0327
Episode 43/50: Reward = 20.00, Steps = 20, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 138, Mod Rate = 0.0000, Viol Rate = 0.0326
Episode 44/50: Reward = 95.00, Steps = 95, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 143, Mod Rate = 0.0000, Viol Rate = 0.0330
Episode 45/50: Reward = 172.00, Steps = 172, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 151, Mod Rate = 0.0000, Viol Rate = 0.0335
Episode 46/50: Reward = 160.00, Steps = 160, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 153, Mod Rate = 0.0000, Viol Rate = 0.0328
Episode 47/50: Reward = 166.00, Steps = 166, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 160, Mod Rate = 0.0000, Viol Rate = 0.0331
Episode 48/50: Reward = 129.00, Steps = 129, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 168, Mod Rate = 0.0000, Viol Rate = 0.0339
Episode 49/50: Reward = 134.00, Steps = 134, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 172, Mod Rate = 0.0000, Viol Rate = 0.0338
Episode 50/50: Reward = 158.00, Steps = 158, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 179, Mod Rate = 0.0000, Viol Rate = 0.0341                                                                                    Best trial: 0. Best value: -0.229067:  20%|██        | 4/20 [09:15<22:56, 86.04s/it]Best trial: 0. Best value: -0.229067:  20%|██        | 4/20 [09:15<22:56, 86.04s/it]Best trial: 0. Best value: -0.229067:  25%|██▌       | 5/20 [09:15<31:04, 124.28s/it]

Evaluation Summary:
Average Reward: 105.04
Standard Deviation: 56.94
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 179
Avg Constraint Violations per Step: 0.0341
[I 2025-12-26 15:19:37,729] Trial 4 finished with value: -0.2997333313351111 and parameters: {'lr': 0.0002190220008462028, 'gamma': 0.9171427386293259, 'hidden_dim': 512, 'use_orthogonal_init': False, 'num_layers': 3, 'cost_gamma': 0.9916410168058936, 'cost_lam': 0.9636195359421077, 'clip_eps': 0.2108753574666748, 'ent_coef': 0.007855150850489606, 'epochs': 6, 'batch_size': 128, 'budget': 0.1426654281391907, 'nu_lr': 0.0015610003778748919}. Best is trial 0 with value: -0.22906666513955556.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x397b7ae50>] [<pishield.propositional_requirements.constraint.Constraint object at 0x39b1a4510>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x37af1de10>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3a2526950>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x3a2552390>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 17.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 17, Viol Rate:  0.097
[Checkpoint] New best avg reward: 17.50 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 23.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 37, Viol Rate:  0.091
[Checkpoint] New best avg reward: 23.30 at episode 20
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 45.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 69, Viol Rate:  0.080
[Checkpoint] New best avg reward: 45.70 at episode 30
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 38.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 88, Viol Rate:  0.071
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 87.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 147, Viol Rate:  0.069
[Checkpoint] New best avg reward: 87.10 at episode 50
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 77.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 218, Viol Rate:  0.075
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 79.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 248, Viol Rate:  0.067
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 74.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 289, Viol Rate:  0.065
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 31.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 305, Viol Rate:  0.064
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 26.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 324, Viol Rate:  0.065
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 42.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 347, Viol Rate:  0.064
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 72.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 390, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 74.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 412, Viol Rate:  0.060
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 26.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 416, Viol Rate:  0.058
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 23.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 424, Viol Rate:  0.057
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 45.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 436, Viol Rate:  0.055
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 29.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 443, Viol Rate:  0.054
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 48.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 456, Viol Rate:  0.053
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 73.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 475, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 134.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 491, Viol Rate:  0.046
[Checkpoint] New best avg reward: 134.50 at episode 200
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 81.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 517, Viol Rate:  0.045
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 57.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 523, Viol Rate:  0.043
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 79.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 531, Viol Rate:  0.041
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 115.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 543, Viol Rate:  0.039
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 79.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 547, Viol Rate:  0.037
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 133.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 552, Viol Rate:  0.034
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 176.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 563, Viol Rate:  0.031
[Checkpoint] New best avg reward: 176.20 at episode 270
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 221.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 572, Viol Rate:  0.028
[Checkpoint] New best avg reward: 221.40 at episode 280
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 144.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 580, Viol Rate:  0.027
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 186.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 585, Viol Rate:  0.025
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 167.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 591, Viol Rate:  0.023
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 212.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 596, Viol Rate:  0.022
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 76.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 598, Viol Rate:  0.021
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 49.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 599, Viol Rate:  0.021
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 125.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 599, Viol Rate:  0.020
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 132.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 602, Viol Rate:  0.019
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 177.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 603, Viol Rate:  0.018
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 92.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 604, Viol Rate:  0.018
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 140.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 605, Viol Rate:  0.017
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 171.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 607, Viol Rate:  0.016
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 82.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 611, Viol Rate:  0.016
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 133.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 611, Viol Rate:  0.016
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 256.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 611, Viol Rate:  0.015
[Checkpoint] New best avg reward: 256.00 at episode 430
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 217.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 611, Viol Rate:  0.014
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 226.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 611, Viol Rate:  0.013
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 131.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 654, Viol Rate:  0.014
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 162.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 662, Viol Rate:  0.014
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 290.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 662, Viol Rate:  0.013
[Checkpoint] New best avg reward: 290.10 at episode 480
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 427.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 662, Viol Rate:  0.012
[Checkpoint] New best avg reward: 427.20 at episode 490
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 228.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 662, Viol Rate:  0.011

[Post-Training] Loading best weights with avg reward: 427.20

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 240.00, Steps = 240, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 2/50: Reward = 234.00, Steps = 234, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 3/50: Reward = 234.00, Steps = 234, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 4/50: Reward = 244.00, Steps = 244, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 5/50: Reward = 230.00, Steps = 230, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 6/50: Reward = 260.00, Steps = 260, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 7/50: Reward = 251.00, Steps = 251, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 8/50: Reward = 244.00, Steps = 244, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 9/50: Reward = 225.00, Steps = 225, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 10/50: Reward = 247.00, Steps = 247, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 11/50: Reward = 239.00, Steps = 239, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 12/50: Reward = 250.00, Steps = 250, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 13/50: Reward = 238.00, Steps = 238, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 14/50: Reward = 223.00, Steps = 223, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 15/50: Reward = 245.00, Steps = 245, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 16/50: Reward = 222.00, Steps = 222, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 17/50: Reward = 252.00, Steps = 252, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 18/50: Reward = 246.00, Steps = 246, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 19/50: Reward = 266.00, Steps = 266, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 20/50: Reward = 261.00, Steps = 261, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 21/50: Reward = 240.00, Steps = 240, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 22/50: Reward = 222.00, Steps = 222, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 23/50: Reward = 232.00, Steps = 232, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 24/50: Reward = 248.00, Steps = 248, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 25/50: Reward = 245.00, Steps = 245, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 26/50: Reward = 253.00, Steps = 253, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 27/50: Reward = 237.00, Steps = 237, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 28/50: Reward = 234.00, Steps = 234, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 29/50: Reward = 224.00, Steps = 224, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 30/50: Reward = 234.00, Steps = 234, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000                                                                                     Best trial: 0. Best value: -0.229067:  25%|██▌       | 5/20 [17:24<31:04, 124.28s/it]Best trial: 0. Best value: -0.229067:  25%|██▌       | 5/20 [17:24<31:04, 124.28s/it]Best trial: 0. Best value: -0.229067:  30%|███       | 6/20 [17:24<57:57, 248.43s/it]
Episode 31/50: Reward = 261.00, Steps = 261, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 32/50: Reward = 239.00, Steps = 239, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 33/50: Reward = 220.00, Steps = 220, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 34/50: Reward = 249.00, Steps = 249, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 35/50: Reward = 267.00, Steps = 267, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 36/50: Reward = 231.00, Steps = 231, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 37/50: Reward = 217.00, Steps = 217, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 38/50: Reward = 252.00, Steps = 252, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 39/50: Reward = 237.00, Steps = 237, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 40/50: Reward = 270.00, Steps = 270, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 41/50: Reward = 255.00, Steps = 255, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 42/50: Reward = 237.00, Steps = 237, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 43/50: Reward = 245.00, Steps = 245, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 44/50: Reward = 270.00, Steps = 270, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 45/50: Reward = 236.00, Steps = 236, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 46/50: Reward = 254.00, Steps = 254, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 47/50: Reward = 257.00, Steps = 257, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 48/50: Reward = 234.00, Steps = 234, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 49/50: Reward = 233.00, Steps = 233, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001
Episode 50/50: Reward = 238.00, Steps = 238, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0001

Evaluation Summary:
Average Reward: 242.44
Standard Deviation: 13.26
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 1
Avg Constraint Violations per Step: 0.0001
[I 2025-12-26 15:27:47,147] Trial 5 finished with value: -0.6162666625582223 and parameters: {'lr': 0.0006226731889144313, 'gamma': 0.9548213713920319, 'hidden_dim': 128, 'use_orthogonal_init': False, 'num_layers': 3, 'cost_gamma': 0.9503339822221201, 'cost_lam': 0.9159002139150197, 'clip_eps': 0.2815567902698376, 'ent_coef': 0.007441374138692653, 'epochs': 7, 'batch_size': 64, 'budget': 0.13736802354306615, 'nu_lr': 0.000502689943894353}. Best is trial 0 with value: -0.22906666513955556.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x3a2536bd0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3c3b4bd50>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x3d6d58d50>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3d6d45790>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x3d6d8bd10>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 17.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 19, Viol Rate:  0.112
[Checkpoint] New best avg reward: 17.00 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 22.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 37, Viol Rate:  0.094
[Checkpoint] New best avg reward: 22.40 at episode 20
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 33.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 69, Viol Rate:  0.095
[Checkpoint] New best avg reward: 33.10 at episode 30
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 29.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 90, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 29.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 108, Viol Rate:  0.082
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 37.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 127, Viol Rate:  0.075
[Checkpoint] New best avg reward: 37.40 at episode 60
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 41.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 158, Viol Rate:  0.075
[Checkpoint] New best avg reward: 41.40 at episode 70
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 47.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 186, Viol Rate:  0.072
[Checkpoint] New best avg reward: 47.30 at episode 80
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 61.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 236, Viol Rate:  0.074
[Checkpoint] New best avg reward: 61.90 at episode 90
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 59.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 302, Viol Rate:  0.080
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 88.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 351, Viol Rate:  0.075
[Checkpoint] New best avg reward: 88.30 at episode 110
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 98.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 419, Viol Rate:  0.074
[Checkpoint] New best avg reward: 98.10 at episode 120
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 83.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 471, Viol Rate:  0.073
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 136.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 529, Viol Rate:  0.067
[Checkpoint] New best avg reward: 136.20 at episode 140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 166.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 610, Viol Rate:  0.064
[Checkpoint] New best avg reward: 166.60 at episode 150
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 172.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 680, Viol Rate:  0.061
[Checkpoint] New best avg reward: 172.50 at episode 160
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 86.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 713, Viol Rate:  0.059
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 29.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 727, Viol Rate:  0.059
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 21.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 732, Viol Rate:  0.058
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 34.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 748, Viol Rate:  0.058
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 44.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 766, Viol Rate:  0.057
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 64.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 789, Viol Rate:  0.056
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 111.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 839, Viol Rate:  0.055
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 42.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 860, Viol Rate:  0.055
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 76.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 884, Viol Rate:  0.054
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 79.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 915, Viol Rate:  0.053
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 85.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 935, Viol Rate:  0.052
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 28.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 938, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 17.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 947, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 30.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 958, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 30.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 968, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 48.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 979, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 44.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 988, Viol Rate:  0.049
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 109.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1010, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 180.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1036, Viol Rate:  0.045
[Checkpoint] New best avg reward: 180.40 at episode 350
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 129.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1059, Viol Rate:  0.044
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 102.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1074, Viol Rate:  0.043
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 60.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1087, Viol Rate:  0.042
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 25.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1090, Viol Rate:  0.042
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 27.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1093, Viol Rate:  0.042
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 35.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1097, Viol Rate:  0.041
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 98.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1102, Viol Rate:  0.040
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 89.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1110, Viol Rate:  0.039
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 61.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1111, Viol Rate:  0.038
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 63.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1116, Viol Rate:  0.037
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 47.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1124, Viol Rate:  0.037
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 34.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1131, Viol Rate:  0.037
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 58.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1136, Viol Rate:  0.036
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 103.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1140, Viol Rate:  0.035
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 59.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1142, Viol Rate:  0.035

[Post-Training] Loading best weights with avg reward: 180.40

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 123.00, Steps = 123, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 6, Mod Rate = 0.0000, Viol Rate = 0.0488
Episode 2/50: Reward = 90.00, Steps = 90, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0376
Episode 3/50: Reward = 54.00, Steps = 54, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 12, Mod Rate = 0.0000, Viol Rate = 0.0449
Episode 4/50: Reward = 106.00, Steps = 106, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 12, Mod Rate = 0.0000, Viol Rate = 0.0322
Episode 5/50: Reward = 118.00, Steps = 118, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 18, Mod Rate = 0.0000, Viol Rate = 0.0367
Episode 6/50: Reward = 116.00, Steps = 116, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 19, Mod Rate = 0.0000, Viol Rate = 0.0313
Episode 7/50: Reward = 115.00, Steps = 115, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 27, Mod Rate = 0.0000, Viol Rate = 0.0374
Episode 8/50: Reward = 115.00, Steps = 115, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 28, Mod Rate = 0.0000, Viol Rate = 0.0335
Episode 9/50: Reward = 73.00, Steps = 73, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.0341                                                                                     Best trial: 0. Best value: -0.229067:  30%|███       | 6/20 [25:06<57:57, 248.43s/it]Best trial: 0. Best value: -0.229067:  30%|███       | 6/20 [25:06<57:57, 248.43s/it]Best trial: 0. Best value: -0.229067:  35%|███▌      | 7/20 [25:06<1:08:56, 318.20s/it]
Episode 10/50: Reward = 105.00, Steps = 105, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 34, Mod Rate = 0.0000, Viol Rate = 0.0335
Episode 11/50: Reward = 131.00, Steps = 131, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 42, Mod Rate = 0.0000, Viol Rate = 0.0366
Episode 12/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 42, Mod Rate = 0.0000, Viol Rate = 0.0362
Episode 13/50: Reward = 123.00, Steps = 123, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 43, Mod Rate = 0.0000, Viol Rate = 0.0335
Episode 14/50: Reward = 79.00, Steps = 79, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 44, Mod Rate = 0.0000, Viol Rate = 0.0323
Episode 15/50: Reward = 94.00, Steps = 94, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 46, Mod Rate = 0.0000, Viol Rate = 0.0316
Episode 16/50: Reward = 114.00, Steps = 114, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.0318
Episode 17/50: Reward = 64.00, Steps = 64, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 53, Mod Rate = 0.0000, Viol Rate = 0.0324
Episode 18/50: Reward = 94.00, Steps = 94, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 54, Mod Rate = 0.0000, Viol Rate = 0.0312
Episode 19/50: Reward = 108.00, Steps = 108, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 57, Mod Rate = 0.0000, Viol Rate = 0.0310
Episode 20/50: Reward = 61.00, Steps = 61, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 58, Mod Rate = 0.0000, Viol Rate = 0.0306
Episode 21/50: Reward = 149.00, Steps = 149, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 65, Mod Rate = 0.0000, Viol Rate = 0.0318
Episode 22/50: Reward = 125.00, Steps = 125, Episode Modifications = 0, Episode Violations = 9, Total Modifications = 0, Total Violations = 74, Mod Rate = 0.0000, Viol Rate = 0.0341
Episode 23/50: Reward = 112.00, Steps = 112, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 77, Mod Rate = 0.0000, Viol Rate = 0.0337
Episode 24/50: Reward = 100.00, Steps = 100, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 77, Mod Rate = 0.0000, Viol Rate = 0.0323
Episode 25/50: Reward = 94.00, Steps = 94, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 77, Mod Rate = 0.0000, Viol Rate = 0.0311
Episode 26/50: Reward = 153.00, Steps = 153, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 79, Mod Rate = 0.0000, Viol Rate = 0.0300
Episode 27/50: Reward = 111.00, Steps = 111, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 80, Mod Rate = 0.0000, Viol Rate = 0.0292
Episode 28/50: Reward = 86.00, Steps = 86, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 80, Mod Rate = 0.0000, Viol Rate = 0.0283
Episode 29/50: Reward = 97.00, Steps = 97, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 80, Mod Rate = 0.0000, Viol Rate = 0.0274
Episode 30/50: Reward = 176.00, Steps = 176, Episode Modifications = 0, Episode Violations = 9, Total Modifications = 0, Total Violations = 89, Mod Rate = 0.0000, Viol Rate = 0.0287
Episode 31/50: Reward = 164.00, Steps = 164, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 95, Mod Rate = 0.0000, Viol Rate = 0.0291
Episode 32/50: Reward = 47.00, Steps = 47, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 95, Mod Rate = 0.0000, Viol Rate = 0.0287
Episode 33/50: Reward = 78.00, Steps = 78, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 98, Mod Rate = 0.0000, Viol Rate = 0.0289
Episode 34/50: Reward = 83.00, Steps = 83, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 98, Mod Rate = 0.0000, Viol Rate = 0.0282
Episode 35/50: Reward = 75.00, Steps = 75, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 99, Mod Rate = 0.0000, Viol Rate = 0.0279
Episode 36/50: Reward = 147.00, Steps = 147, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 109, Mod Rate = 0.0000, Viol Rate = 0.0295
Episode 37/50: Reward = 129.00, Steps = 129, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 114, Mod Rate = 0.0000, Viol Rate = 0.0298
Episode 38/50: Reward = 65.00, Steps = 65, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 115, Mod Rate = 0.0000, Viol Rate = 0.0296
Episode 39/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 115, Mod Rate = 0.0000, Viol Rate = 0.0295
Episode 40/50: Reward = 17.00, Steps = 17, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 116, Mod Rate = 0.0000, Viol Rate = 0.0296
Episode 41/50: Reward = 158.00, Steps = 158, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 118, Mod Rate = 0.0000, Viol Rate = 0.0289
Episode 42/50: Reward = 94.00, Steps = 94, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 118, Mod Rate = 0.0000, Viol Rate = 0.0283
Episode 43/50: Reward = 119.00, Steps = 119, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 122, Mod Rate = 0.0000, Viol Rate = 0.0284
Episode 44/50: Reward = 167.00, Steps = 167, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 130, Mod Rate = 0.0000, Viol Rate = 0.0292
Episode 45/50: Reward = 91.00, Steps = 91, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 130, Mod Rate = 0.0000, Viol Rate = 0.0286
Episode 46/50: Reward = 62.00, Steps = 62, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 131, Mod Rate = 0.0000, Viol Rate = 0.0284
Episode 47/50: Reward = 117.00, Steps = 117, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 131, Mod Rate = 0.0000, Viol Rate = 0.0277
Episode 48/50: Reward = 144.00, Steps = 144, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 133, Mod Rate = 0.0000, Viol Rate = 0.0273
Episode 49/50: Reward = 134.00, Steps = 134, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 138, Mod Rate = 0.0000, Viol Rate = 0.0276
Episode 50/50: Reward = 71.00, Steps = 71, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 139, Mod Rate = 0.0000, Viol Rate = 0.0274

Evaluation Summary:
Average Reward: 101.54
Standard Deviation: 37.34
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 139
Avg Constraint Violations per Step: 0.0274
[I 2025-12-26 15:35:28,991] Trial 6 finished with value: -0.32306666451288885 and parameters: {'lr': 0.0014558073753414644, 'gamma': 0.9704297510338848, 'hidden_dim': 128, 'use_orthogonal_init': False, 'num_layers': 3, 'cost_gamma': 0.9621661432550181, 'cost_lam': 0.9405814805589189, 'clip_eps': 0.25186259783600756, 'ent_coef': 0.013691799324730703, 'epochs': 2, 'batch_size': 64, 'budget': 0.11279886691032169, 'nu_lr': 0.004790198531334812}. Best is trial 0 with value: -0.22906666513955556.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x3f489b1d0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3d31dc3d0>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x3dc254f10>] [<pishield.propositional_requirements.constraint.Constraint object at 0x37fcf3350>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x3d31fbcd0>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 25.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 40, Viol Rate:  0.159
[Checkpoint] New best avg reward: 25.10 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 148.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 159, Viol Rate:  0.092
[Checkpoint] New best avg reward: 148.60 at episode 20
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 36.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 192, Viol Rate:  0.091
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 10.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 205, Viol Rate:  0.093
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 10.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 218, Viol Rate:  0.095
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 90.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 350, Viol Rate:  0.109
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 154.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 451, Viol Rate:  0.095
[Checkpoint] New best avg reward: 154.40 at episode 70
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 59.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 555, Viol Rate:  0.104
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 172.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 625, Viol Rate:  0.088
[Checkpoint] New best avg reward: 172.90 at episode 90
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 33.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 645, Viol Rate:  0.087
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 658, Viol Rate:  0.087
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 672, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 687, Viol Rate:  0.089
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 699, Viol Rate:  0.090
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 9.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 711, Viol Rate:  0.090
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 10.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 725, Viol Rate:  0.091
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 740, Viol Rate:  0.091
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 10.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 752, Viol Rate:  0.092
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 767, Viol Rate:  0.092
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 782, Viol Rate:  0.093
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 11.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 794, Viol Rate:  0.093
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 69.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 833, Viol Rate:  0.091
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 137.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 894, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 91.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 988, Viol Rate:  0.086
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 127.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1013, Viol Rate:  0.079
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 66.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1021, Viol Rate:  0.076
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 11.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1031, Viol Rate:  0.076
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 10.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1043, Viol Rate:  0.077
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1055, Viol Rate:  0.077
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1069, Viol Rate:  0.077
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 10.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1076, Viol Rate:  0.077
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 16.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1086, Viol Rate:  0.077
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 12.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1098, Viol Rate:  0.077
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 18.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1109, Viol Rate:  0.077
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 114.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1114, Viol Rate:  0.072
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 149.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1118, Viol Rate:  0.066
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 215.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1129, Viol Rate:  0.059
[Checkpoint] New best avg reward: 215.30 at episode 370
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 74.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1142, Viol Rate:  0.057
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 21.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1150, Viol Rate:  0.057
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 240.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1151, Viol Rate:  0.051
[Checkpoint] New best avg reward: 240.20 at episode 400
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 26.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1157, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 12.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1159, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 18.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1160, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 114.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1160, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 113.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1160, Viol Rate:  0.046
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 171.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1163, Viol Rate:  0.043
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 232.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1163, Viol Rate:  0.040
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 121.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1167, Viol Rate:  0.038
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 156.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1173, Viol Rate:  0.036
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 18.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1181, Viol Rate:  0.036

[Post-Training] Loading best weights with avg reward: 240.20

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 143.00, Steps = 143, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 2/50: Reward = 152.00, Steps = 152, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 3/50: Reward = 161.00, Steps = 161, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 4/50: Reward = 122.00, Steps = 122, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 5/50: Reward = 85.00, Steps = 85, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 6/50: Reward = 38.00, Steps = 38, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 7/50: Reward = 116.00, Steps = 116, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 8/50: Reward = 117.00, Steps = 117, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 9/50: Reward = 116.00, Steps = 116, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 10/50: Reward = 140.00, Steps = 140, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 11/50: Reward = 157.00, Steps = 157, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 12/50: Reward = 162.00, Steps = 162, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 13/50: Reward = 96.00, Steps = 96, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 14/50: Reward = 126.00, Steps = 126, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 15/50: Reward = 110.00, Steps = 110, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 16/50: Reward = 108.00, Steps = 108, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 17/50: Reward = 144.00, Steps = 144, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 18/50: Reward = 80.00, Steps = 80, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 19/50: Reward = 139.00, Steps = 139, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 20/50: Reward = 109.00, Steps = 109, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 21/50: Reward = 154.00, Steps = 154, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 22/50: Reward = 140.00, Steps = 140, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 23/50: Reward = 152.00, Steps = 152, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 24/50: Reward = 129.00, Steps = 129, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 25/50: Reward = 138.00, Steps = 138, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 26/50: Reward = 120.00, Steps = 120, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 27/50: Reward = 110.00, Steps = 110, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 28/50: Reward = 141.00, Steps = 141, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 29/50: Reward = 120.00, Steps = 120, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 30/50: Reward = 142.00, Steps = 142, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 31/50: Reward = 109.00, Steps = 109, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 32/50: Reward = 82.00, Steps = 82, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 33/50: Reward = 86.00, Steps = 86, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 34/50: Reward = 110.00, Steps = 110, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 35/50: Reward = 127.00, Steps = 127, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 36/50: Reward = 109.00, Steps = 109, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000                                                                                       Best trial: 0. Best value: -0.229067:  35%|███▌      | 7/20 [31:54<1:08:56, 318.20s/it]Best trial: 7. Best value: -0.174533:  35%|███▌      | 7/20 [31:54<1:08:56, 318.20s/it]Best trial: 7. Best value: -0.174533:  40%|████      | 8/20 [31:54<1:09:22, 346.85s/it]
Episode 37/50: Reward = 106.00, Steps = 106, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 38/50: Reward = 154.00, Steps = 154, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 39/50: Reward = 88.00, Steps = 88, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 40/50: Reward = 182.00, Steps = 182, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 41/50: Reward = 134.00, Steps = 134, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 42/50: Reward = 124.00, Steps = 124, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 43/50: Reward = 133.00, Steps = 133, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 44/50: Reward = 151.00, Steps = 151, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 45/50: Reward = 93.00, Steps = 93, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 46/50: Reward = 99.00, Steps = 99, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 47/50: Reward = 127.00, Steps = 127, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 48/50: Reward = 126.00, Steps = 126, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 49/50: Reward = 148.00, Steps = 148, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 50/50: Reward = 136.00, Steps = 136, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000

Evaluation Summary:
Average Reward: 123.82
Standard Deviation: 26.23
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 0
Avg Constraint Violations per Step: 0.0000
[I 2025-12-26 15:42:17,183] Trial 7 finished with value: -0.17453333216977784 and parameters: {'lr': 0.0023908179676368686, 'gamma': 0.9880805881161417, 'hidden_dim': 512, 'use_orthogonal_init': False, 'num_layers': 2, 'cost_gamma': 0.9513283787660629, 'cost_lam': 0.9571426655077937, 'clip_eps': 0.18726729339820467, 'ent_coef': 0.02154667969393176, 'epochs': 5, 'batch_size': 128, 'budget': 0.12471661781427078, 'nu_lr': 0.0016595613517636665}. Best is trial 7 with value: -0.17453333216977784.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x414c69c50>] [<pishield.propositional_requirements.constraint.Constraint object at 0x414c6e710>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x414c9c9d0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x414c95490>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x414cacb50>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 17.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 19, Viol Rate:  0.106
[Checkpoint] New best avg reward: 17.90 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 17.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 32, Viol Rate:  0.091
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 47, Viol Rate:  0.106
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 8.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 58, Viol Rate:  0.109
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 9.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 71, Viol Rate:  0.113
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 9.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 84, Viol Rate:  0.117
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 99, Viol Rate:  0.122
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 110, Viol Rate:  0.121
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 122, Viol Rate:  0.121
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 136, Viol Rate:  0.124
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 148, Viol Rate:  0.124
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 160, Viol Rate:  0.124
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 170, Viol Rate:  0.123
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 182, Viol Rate:  0.123
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 193, Viol Rate:  0.122
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 205, Viol Rate:  0.123
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 219, Viol Rate:  0.124
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 8.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 231, Viol Rate:  0.124
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 8.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 244, Viol Rate:  0.125
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 257, Viol Rate:  0.126
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 271, Viol Rate:  0.127
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 284, Viol Rate:  0.127
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 294, Viol Rate:  0.127
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 305, Viol Rate:  0.126
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 318, Viol Rate:  0.127
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 8.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 331, Viol Rate:  0.127
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 342, Viol Rate:  0.127
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 354, Viol Rate:  0.127
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 370, Viol Rate:  0.128
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 383, Viol Rate:  0.129
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 394, Viol Rate:  0.128
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 408, Viol Rate:  0.129
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 421, Viol Rate:  0.129
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 434, Viol Rate:  0.129
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 447, Viol Rate:  0.130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 459, Viol Rate:  0.130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 473, Viol Rate:  0.130
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 488, Viol Rate:  0.131
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 500, Viol Rate:  0.131
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 513, Viol Rate:  0.131
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 525, Viol Rate:  0.131
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 538, Viol Rate:  0.131
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 551, Viol Rate:  0.131
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 564, Viol Rate:  0.131
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 576, Viol Rate:  0.131
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 590, Viol Rate:  0.132
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 605, Viol Rate:  0.132
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 618, Viol Rate:  0.132
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 629, Viol Rate:  0.132
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 643, Viol Rate:  0.132

[Post-Training] Loading best weights with avg reward: 17.90

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 2, Mod Rate = 0.0000, Viol Rate = 0.2222
Episode 2/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 4, Mod Rate = 0.0000, Viol Rate = 0.2105
Episode 3/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 5, Mod Rate = 0.0000, Viol Rate = 0.1786
Episode 4/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 6, Mod Rate = 0.0000, Viol Rate = 0.1395
Episode 5/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.1538
Episode 6/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 10, Mod Rate = 0.0000, Viol Rate = 0.1587
Episode 7/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 11, Mod Rate = 0.0000, Viol Rate = 0.1507
Episode 8/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 12, Mod Rate = 0.0000, Viol Rate = 0.1463
Episode 9/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 13, Mod Rate = 0.0000, Viol Rate = 0.1413
Episode 10/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 14, Mod Rate = 0.0000, Viol Rate = 0.1386
Episode 11/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 15, Mod Rate = 0.0000, Viol Rate = 0.1327
Episode 12/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 16, Mod Rate = 0.0000, Viol Rate = 0.1311
Episode 13/50: Reward = 8.00, Steps = 8, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 17, Mod Rate = 0.0000, Viol Rate = 0.1308
Episode 14/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 19, Mod Rate = 0.0000, Viol Rate = 0.1357
Episode 15/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 20, Mod Rate = 0.0000, Viol Rate = 0.1316
Episode 16/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 21, Mod Rate = 0.0000, Viol Rate = 0.1288
Episode 17/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 22, Mod Rate = 0.0000, Viol Rate = 0.1272
Episode 18/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 24, Mod Rate = 0.0000, Viol Rate = 0.1290
Episode 19/50: Reward = 8.00, Steps = 8, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 25, Mod Rate = 0.0000, Viol Rate = 0.1289                                                                                       Best trial: 7. Best value: -0.174533:  40%|████      | 8/20 [39:20<1:09:22, 346.85s/it]Best trial: 7. Best value: -0.174533:  40%|████      | 8/20 [39:20<1:09:22, 346.85s/it]Best trial: 7. Best value: -0.174533:  45%|████▌     | 9/20 [39:20<1:09:16, 377.86s/it]
Episode 20/50: Reward = 8.00, Steps = 8, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 26, Mod Rate = 0.0000, Viol Rate = 0.1287
Episode 21/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 28, Mod Rate = 0.0000, Viol Rate = 0.1327
Episode 22/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 29, Mod Rate = 0.0000, Viol Rate = 0.1289
Episode 23/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.1319
Episode 24/50: Reward = 8.00, Steps = 8, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 32, Mod Rate = 0.0000, Viol Rate = 0.1317
Episode 25/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 33, Mod Rate = 0.0000, Viol Rate = 0.1304
Episode 26/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 33, Mod Rate = 0.0000, Viol Rate = 0.1245
Episode 27/50: Reward = 17.00, Steps = 17, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 34, Mod Rate = 0.0000, Viol Rate = 0.1206
Episode 28/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 35, Mod Rate = 0.0000, Viol Rate = 0.1199
Episode 29/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 36, Mod Rate = 0.0000, Viol Rate = 0.1196
Episode 30/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 37, Mod Rate = 0.0000, Viol Rate = 0.1194
Episode 31/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 38, Mod Rate = 0.0000, Viol Rate = 0.1187
Episode 32/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.1185
Episode 33/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 40, Mod Rate = 0.0000, Viol Rate = 0.1180
Episode 34/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 42, Mod Rate = 0.0000, Viol Rate = 0.1203
Episode 35/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 43, Mod Rate = 0.0000, Viol Rate = 0.1201
Episode 36/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 44, Mod Rate = 0.0000, Viol Rate = 0.1189
Episode 37/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 45, Mod Rate = 0.0000, Viol Rate = 0.1178
Episode 38/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 47, Mod Rate = 0.0000, Viol Rate = 0.1202
Episode 39/50: Reward = 8.00, Steps = 8, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 48, Mod Rate = 0.0000, Viol Rate = 0.1203
Episode 40/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 49, Mod Rate = 0.0000, Viol Rate = 0.1198
Episode 41/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 51, Mod Rate = 0.0000, Viol Rate = 0.1220
Episode 42/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 52, Mod Rate = 0.0000, Viol Rate = 0.1218
Episode 43/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 53, Mod Rate = 0.0000, Viol Rate = 0.1213
Episode 44/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 54, Mod Rate = 0.0000, Viol Rate = 0.1203
Episode 45/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 56, Mod Rate = 0.0000, Viol Rate = 0.1223
Episode 46/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 57, Mod Rate = 0.0000, Viol Rate = 0.1218
Episode 47/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 58, Mod Rate = 0.0000, Viol Rate = 0.1216
Episode 48/50: Reward = 8.00, Steps = 8, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 59, Mod Rate = 0.0000, Viol Rate = 0.1216
Episode 49/50: Reward = 17.00, Steps = 17, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 61, Mod Rate = 0.0000, Viol Rate = 0.1215
Episode 50/50: Reward = 8.00, Steps = 8, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.1216

Evaluation Summary:
Average Reward: 10.20
Standard Deviation: 2.08
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 62
Avg Constraint Violations per Step: 0.1216
[I 2025-12-26 15:49:43,238] Trial 8 finished with value: -0.9319999937866668 and parameters: {'lr': 0.0033484663294266075, 'gamma': 0.962500958775016, 'hidden_dim': 512, 'use_orthogonal_init': True, 'num_layers': 3, 'cost_gamma': 0.9069686136256085, 'cost_lam': 0.9332718390946131, 'clip_eps': 0.1263473341453106, 'ent_coef': 0.017540503673807505, 'epochs': 4, 'batch_size': 32, 'budget': 0.2481433017439072, 'nu_lr': 0.00015530497737537366}. Best is trial 7 with value: -0.17453333216977784.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x416fd2310>] [<pishield.propositional_requirements.constraint.Constraint object at 0x414c35d10>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x416ad4d50>] [<pishield.propositional_requirements.constraint.Constraint object at 0x3dd25bc50>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x4174d3810>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 19.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 18, Viol Rate:  0.093
[Checkpoint] New best avg reward: 19.40 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 18.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 38, Viol Rate:  0.099
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 18.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 51, Viol Rate:  0.089
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 15.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 64, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 17.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 81, Viol Rate:  0.090
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 41.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 122, Viol Rate:  0.093
[Checkpoint] New best avg reward: 41.10 at episode 60
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 46.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 148, Viol Rate:  0.083
[Checkpoint] New best avg reward: 46.80 at episode 70
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 80.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 190, Viol Rate:  0.073
[Checkpoint] New best avg reward: 80.90 at episode 80
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 127.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 276, Viol Rate:  0.071
[Checkpoint] New best avg reward: 127.80 at episode 90
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 79.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 314, Viol Rate:  0.067
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 52.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 354, Viol Rate:  0.068
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 36.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 377, Viol Rate:  0.068
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 24.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 385, Viol Rate:  0.066
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 40.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 411, Viol Rate:  0.066
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 31.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 426, Viol Rate:  0.065
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 47.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 445, Viol Rate:  0.064
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 51.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 467, Viol Rate:  0.062
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 39.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 491, Viol Rate:  0.062
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 81.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 525, Viol Rate:  0.060
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 112.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 558, Viol Rate:  0.057
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 45.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 579, Viol Rate:  0.056
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 64.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 617, Viol Rate:  0.056
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 37.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 632, Viol Rate:  0.056
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 30.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 636, Viol Rate:  0.055
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 54.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 643, Viol Rate:  0.053
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 27.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 647, Viol Rate:  0.052
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 34.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 655, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 29.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 658, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 39.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 661, Viol Rate:  0.049
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 80.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 677, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 131.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 688, Viol Rate:  0.044
[Checkpoint] New best avg reward: 131.10 at episode 310
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 209.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 713, Viol Rate:  0.040
[Checkpoint] New best avg reward: 209.50 at episode 320
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 102.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 726, Viol Rate:  0.039
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 39.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 731, Viol Rate:  0.038
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 49.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 736, Viol Rate:  0.038
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 31.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 742, Viol Rate:  0.037
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 50.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 749, Viol Rate:  0.037
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 257.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 759, Viol Rate:  0.033
[Checkpoint] New best avg reward: 257.60 at episode 380
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 271.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 768, Viol Rate:  0.030
[Checkpoint] New best avg reward: 271.40 at episode 390
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 72.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 771, Viol Rate:  0.029
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 83.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 777, Viol Rate:  0.029
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 86.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 784, Viol Rate:  0.028
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 58.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 789, Viol Rate:  0.028
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 81.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 794, Viol Rate:  0.027
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 132.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 796, Viol Rate:  0.026
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 41.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 798, Viol Rate:  0.026
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 23.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 802, Viol Rate:  0.025
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 25.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 804, Viol Rate:  0.025
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 45.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 805, Viol Rate:  0.025
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 65.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 809, Viol Rate:  0.025

[Post-Training] Loading best weights with avg reward: 271.40

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 55.00, Steps = 55, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 2/50: Reward = 39.00, Steps = 39, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 3/50: Reward = 170.00, Steps = 170, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0038
Episode 4/50: Reward = 65.00, Steps = 65, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0030
Episode 5/50: Reward = 52.00, Steps = 52, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0026
Episode 6/50: Reward = 33.00, Steps = 33, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0024
Episode 7/50: Reward = 78.00, Steps = 78, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 2, Mod Rate = 0.0000, Viol Rate = 0.0041
Episode 8/50: Reward = 77.00, Steps = 77, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 2, Mod Rate = 0.0000, Viol Rate = 0.0035
Episode 9/50: Reward = 147.00, Steps = 147, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 3, Mod Rate = 0.0000, Viol Rate = 0.0042
Episode 10/50: Reward = 76.00, Steps = 76, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 4, Mod Rate = 0.0000, Viol Rate = 0.0051
Episode 11/50: Reward = 102.00, Steps = 102, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 4, Mod Rate = 0.0000, Viol Rate = 0.0045
Episode 12/50: Reward = 31.00, Steps = 31, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 4, Mod Rate = 0.0000, Viol Rate = 0.0043
Episode 13/50: Reward = 32.00, Steps = 32, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 4, Mod Rate = 0.0000, Viol Rate = 0.0042
Episode 14/50: Reward = 232.00, Steps = 232, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 6, Mod Rate = 0.0000, Viol Rate = 0.0050
Episode 15/50: Reward = 49.00, Steps = 49, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 6, Mod Rate = 0.0000, Viol Rate = 0.0048
Episode 16/50: Reward = 138.00, Steps = 138, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0051
Episode 17/50: Reward = 67.00, Steps = 67, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0049
Episode 18/50: Reward = 81.00, Steps = 81, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0046
Episode 19/50: Reward = 133.00, Steps = 133, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0042
Episode 20/50: Reward = 32.00, Steps = 32, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0047
Episode 21/50: Reward = 60.00, Steps = 60, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0046
Episode 22/50: Reward = 56.00, Steps = 56, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0044
Episode 23/50: Reward = 204.00, Steps = 204, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0040
Episode 24/50: Reward = 167.00, Steps = 167, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0037
Episode 25/50: Reward = 154.00, Steps = 154, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 9, Mod Rate = 0.0000, Viol Rate = 0.0039
Episode 26/50: Reward = 84.00, Steps = 84, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 9, Mod Rate = 0.0000, Viol Rate = 0.0037
Episode 27/50: Reward = 101.00, Steps = 101, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 9, Mod Rate = 0.0000, Viol Rate = 0.0036
Episode 28/50: Reward = 31.00, Steps = 31, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 9, Mod Rate = 0.0000, Viol Rate = 0.0035
Episode 29/50: Reward = 267.00, Steps = 267, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 16, Mod Rate = 0.0000, Viol Rate = 0.0057
Episode 30/50: Reward = 82.00, Steps = 82, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 17, Mod Rate = 0.0000, Viol Rate = 0.0059
Episode 31/50: Reward = 38.00, Steps = 38, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 20, Mod Rate = 0.0000, Viol Rate = 0.0068
Episode 32/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 20, Mod Rate = 0.0000, Viol Rate = 0.0068
Episode 33/50: Reward = 94.00, Steps = 94, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 22, Mod Rate = 0.0000, Viol Rate = 0.0072
Episode 34/50: Reward = 109.00, Steps = 109, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 24, Mod Rate = 0.0000, Viol Rate = 0.0076
Episode 35/50: Reward = 103.00, Steps = 103, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 24, Mod Rate = 0.0000, Viol Rate = 0.0074
Episode 36/50: Reward = 103.00, Steps = 103, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 24, Mod Rate = 0.0000, Viol Rate = 0.0071
Episode 37/50: Reward = 95.00, Steps = 95, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 25, Mod Rate = 0.0000, Viol Rate = 0.0072
Episode 38/50: Reward = 83.00, Steps = 83, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 27, Mod Rate = 0.0000, Viol Rate = 0.0076
Episode 39/50: Reward = 42.00, Steps = 42, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 27, Mod Rate = 0.0000, Viol Rate = 0.0075
Episode 40/50: Reward = 181.00, Steps = 181, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 28, Mod Rate = 0.0000, Viol Rate = 0.0075
Episode 41/50: Reward = 54.00, Steps = 54, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 28, Mod Rate = 0.0000, Viol Rate = 0.0073
Episode 42/50: Reward = 116.00, Steps = 116, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 29, Mod Rate = 0.0000, Viol Rate = 0.0074
Episode 43/50: Reward = 60.00, Steps = 60, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 29, Mod Rate = 0.0000, Viol Rate = 0.0073
Episode 44/50: Reward = 52.00, Steps = 52, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 29, Mod Rate = 0.0000, Viol Rate = 0.0072
Episode 45/50: Reward = 32.00, Steps = 32, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.0076                                                                                       Best trial: 7. Best value: -0.174533:  45%|████▌     | 9/20 [51:56<1:09:16, 377.86s/it]Best trial: 7. Best value: -0.174533:  45%|████▌     | 9/20 [51:56<1:09:16, 377.86s/it]Best trial: 7. Best value: -0.174533:  50%|█████     | 10/20 [51:56<1:22:25, 494.51s/it]
Episode 46/50: Reward = 85.00, Steps = 85, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.0075
Episode 47/50: Reward = 64.00, Steps = 64, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.0073
Episode 48/50: Reward = 114.00, Steps = 114, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.0072
Episode 49/50: Reward = 71.00, Steps = 71, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.0070
Episode 50/50: Reward = 39.00, Steps = 39, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.0070

Evaluation Summary:
Average Reward: 88.90
Standard Deviation: 54.39
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 31
Avg Constraint Violations per Step: 0.0070
[I 2025-12-26 16:02:18,961] Trial 9 finished with value: -0.40733333061777777 and parameters: {'lr': 0.0018436326555658627, 'gamma': 0.9551581609734894, 'hidden_dim': 128, 'use_orthogonal_init': False, 'num_layers': 4, 'cost_gamma': 0.9458522255373943, 'cost_lam': 0.9540592584782428, 'clip_eps': 0.14202085553816673, 'ent_coef': 0.04471303776872391, 'epochs': 3, 'batch_size': 128, 'budget': 0.10124998669661418, 'nu_lr': 0.0002944093717219494}. Best is trial 7 with value: -0.17453333216977784.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x441fc7ed0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x441fc4a90>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x441ff2c10>] [<pishield.propositional_requirements.constraint.Constraint object at 0x441feb6d0>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x441ffed90>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 33.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 23, Viol Rate:  0.068
[Checkpoint] New best avg reward: 33.80 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 21.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 43, Viol Rate:  0.078
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 19.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 60, Viol Rate:  0.080
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 50.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 102, Viol Rate:  0.082
[Checkpoint] New best avg reward: 50.10 at episode 40
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 36.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 125, Viol Rate:  0.077
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 37.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 150, Viol Rate:  0.075
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 44.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 181, Viol Rate:  0.074
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 19.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 195, Viol Rate:  0.074
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 21.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 208, Viol Rate:  0.073
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 33.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 219, Viol Rate:  0.069
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 28.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 239, Viol Rate:  0.069
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 35.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 247, Viol Rate:  0.065
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 28.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 268, Viol Rate:  0.065
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 80.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 310, Viol Rate:  0.063
[Checkpoint] New best avg reward: 80.10 at episode 140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 135.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 393, Viol Rate:  0.063
[Checkpoint] New best avg reward: 135.90 at episode 150
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 55.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 416, Viol Rate:  0.061
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 49.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 452, Viol Rate:  0.062
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 35.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 460, Viol Rate:  0.060
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 56.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 480, Viol Rate:  0.058
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 26.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 487, Viol Rate:  0.057
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 25.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 492, Viol Rate:  0.056
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 38.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 501, Viol Rate:  0.055
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 36.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 513, Viol Rate:  0.054
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 110.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 560, Viol Rate:  0.053
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 115.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 594, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 110.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 628, Viol Rate:  0.049
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 52.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 638, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 52.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 647, Viol Rate:  0.046
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 43.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 655, Viol Rate:  0.046
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 42.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 662, Viol Rate:  0.045
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 25.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 669, Viol Rate:  0.044
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 27.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 673, Viol Rate:  0.044
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 21.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 681, Viol Rate:  0.044
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 27.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 685, Viol Rate:  0.043
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 135.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 716, Viol Rate:  0.042
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 230.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 755, Viol Rate:  0.039
[Checkpoint] New best avg reward: 230.50 at episode 360
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 231.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 790, Viol Rate:  0.036
[Checkpoint] New best avg reward: 231.20 at episode 370
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 315.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 841, Viol Rate:  0.034
[Checkpoint] New best avg reward: 315.20 at episode 380
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 274.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 850, Viol Rate:  0.031
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 170.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 870, Viol Rate:  0.030
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 63.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 888, Viol Rate:  0.030
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 118.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 895, Viol Rate:  0.029
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 244.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 907, Viol Rate:  0.027
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 157.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 925, Viol Rate:  0.026
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 156.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 982, Viol Rate:  0.027
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 146.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1090, Viol Rate:  0.028
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 141.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1184, Viol Rate:  0.030
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 122.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1300, Viol Rate:  0.032
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 165.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1333, Viol Rate:  0.031
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 147.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1337, Viol Rate:  0.030

[Post-Training] Loading best weights with avg reward: 315.20

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 242.00, Steps = 242, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 2/50: Reward = 172.00, Steps = 172, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0024
Episode 3/50: Reward = 63.00, Steps = 63, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0021
Episode 4/50: Reward = 166.00, Steps = 166, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 3, Mod Rate = 0.0000, Viol Rate = 0.0047
Episode 5/50: Reward = 148.00, Steps = 148, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 5, Mod Rate = 0.0000, Viol Rate = 0.0063
Episode 6/50: Reward = 272.00, Steps = 272, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0066
Episode 7/50: Reward = 27.00, Steps = 27, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0064
Episode 8/50: Reward = 109.00, Steps = 109, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 9, Mod Rate = 0.0000, Viol Rate = 0.0075
Episode 9/50: Reward = 236.00, Steps = 236, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 15, Mod Rate = 0.0000, Viol Rate = 0.0105
Episode 10/50: Reward = 78.00, Steps = 78, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 15, Mod Rate = 0.0000, Viol Rate = 0.0099
Episode 11/50: Reward = 330.00, Steps = 330, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 18, Mod Rate = 0.0000, Viol Rate = 0.0098
Episode 12/50: Reward = 105.00, Steps = 105, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 23, Mod Rate = 0.0000, Viol Rate = 0.0118
Episode 13/50: Reward = 216.00, Steps = 216, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 26, Mod Rate = 0.0000, Viol Rate = 0.0120
Episode 14/50: Reward = 60.00, Steps = 60, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 26, Mod Rate = 0.0000, Viol Rate = 0.0117
Episode 15/50: Reward = 100.00, Steps = 100, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 26, Mod Rate = 0.0000, Viol Rate = 0.0112
Episode 16/50: Reward = 294.00, Steps = 294, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 32, Mod Rate = 0.0000, Viol Rate = 0.0122
Episode 17/50: Reward = 153.00, Steps = 153, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 34, Mod Rate = 0.0000, Viol Rate = 0.0123
Episode 18/50: Reward = 184.00, Steps = 184, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 34, Mod Rate = 0.0000, Viol Rate = 0.0115
Episode 19/50: Reward = 146.00, Steps = 146, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.0126
Episode 20/50: Reward = 55.00, Steps = 55, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 41, Mod Rate = 0.0000, Viol Rate = 0.0130
Episode 21/50: Reward = 79.00, Steps = 79, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 43, Mod Rate = 0.0000, Viol Rate = 0.0133
Episode 22/50: Reward = 64.00, Steps = 64, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 44, Mod Rate = 0.0000, Viol Rate = 0.0133
Episode 23/50: Reward = 198.00, Steps = 198, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 47, Mod Rate = 0.0000, Viol Rate = 0.0134
Episode 24/50: Reward = 188.00, Steps = 188, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 49, Mod Rate = 0.0000, Viol Rate = 0.0133
Episode 25/50: Reward = 49.00, Steps = 49, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 49, Mod Rate = 0.0000, Viol Rate = 0.0131
Episode 26/50: Reward = 114.00, Steps = 114, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 52, Mod Rate = 0.0000, Viol Rate = 0.0135                                                                                        Best trial: 7. Best value: -0.174533:  50%|█████     | 10/20 [1:34:22<1:22:25, 494.51s/it]Best trial: 10. Best value: -0.0173333:  50%|█████     | 10/20 [1:34:22<1:22:25, 494.51s/it]Best trial: 10. Best value: -0.0173333:  55%|█████▌    | 11/20 [1:34:22<2:48:22, 1122.45s/it]
Episode 27/50: Reward = 89.00, Steps = 89, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 52, Mod Rate = 0.0000, Viol Rate = 0.0132
Episode 28/50: Reward = 177.00, Steps = 177, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 56, Mod Rate = 0.0000, Viol Rate = 0.0136
Episode 29/50: Reward = 39.00, Steps = 39, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 58, Mod Rate = 0.0000, Viol Rate = 0.0140
Episode 30/50: Reward = 36.00, Steps = 36, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 58, Mod Rate = 0.0000, Viol Rate = 0.0138
Episode 31/50: Reward = 308.00, Steps = 308, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0138
Episode 32/50: Reward = 19.00, Steps = 19, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0137
Episode 33/50: Reward = 124.00, Steps = 124, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 64, Mod Rate = 0.0000, Viol Rate = 0.0138
Episode 34/50: Reward = 259.00, Steps = 259, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 72, Mod Rate = 0.0000, Viol Rate = 0.0147
Episode 35/50: Reward = 91.00, Steps = 91, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 72, Mod Rate = 0.0000, Viol Rate = 0.0144
Episode 36/50: Reward = 144.00, Steps = 144, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 72, Mod Rate = 0.0000, Viol Rate = 0.0140
Episode 37/50: Reward = 80.00, Steps = 80, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 72, Mod Rate = 0.0000, Viol Rate = 0.0138
Episode 38/50: Reward = 412.00, Steps = 412, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 80, Mod Rate = 0.0000, Viol Rate = 0.0142
Episode 39/50: Reward = 239.00, Steps = 239, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 84, Mod Rate = 0.0000, Viol Rate = 0.0143
Episode 40/50: Reward = 178.00, Steps = 178, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 86, Mod Rate = 0.0000, Viol Rate = 0.0142
Episode 41/50: Reward = 71.00, Steps = 71, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 88, Mod Rate = 0.0000, Viol Rate = 0.0144
Episode 42/50: Reward = 50.00, Steps = 50, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 90, Mod Rate = 0.0000, Viol Rate = 0.0146
Episode 43/50: Reward = 70.00, Steps = 70, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 90, Mod Rate = 0.0000, Viol Rate = 0.0144
Episode 44/50: Reward = 289.00, Steps = 289, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 97, Mod Rate = 0.0000, Viol Rate = 0.0149
Episode 45/50: Reward = 101.00, Steps = 101, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 100, Mod Rate = 0.0000, Viol Rate = 0.0151
Episode 46/50: Reward = 50.00, Steps = 50, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 101, Mod Rate = 0.0000, Viol Rate = 0.0151
Episode 47/50: Reward = 329.00, Steps = 329, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 101, Mod Rate = 0.0000, Viol Rate = 0.0144
Episode 48/50: Reward = 171.00, Steps = 171, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 102, Mod Rate = 0.0000, Viol Rate = 0.0142
Episode 49/50: Reward = 341.00, Steps = 341, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 108, Mod Rate = 0.0000, Viol Rate = 0.0144
Episode 50/50: Reward = 115.00, Steps = 115, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 108, Mod Rate = 0.0000, Viol Rate = 0.0142

Evaluation Summary:
Average Reward: 152.60
Standard Deviation: 96.28
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 108
Avg Constraint Violations per Step: 0.0142
[I 2025-12-26 16:44:45,197] Trial 10 finished with value: -0.01733333321777774 and parameters: {'lr': 0.00013487852956240443, 'gamma': 0.9960534712203585, 'hidden_dim': 512, 'use_orthogonal_init': False, 'num_layers': 2, 'cost_gamma': 0.9083463455004739, 'cost_lam': 0.9793707896021834, 'clip_eps': 0.18286856450348415, 'ent_coef': 0.0009894243679250125, 'epochs': 10, 'batch_size': 32, 'budget': 0.20258628609558368, 'nu_lr': 0.009244303191711047}. Best is trial 10 with value: -0.01733333321777774.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x43958f0d0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x43958d890>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x4395e2490>] [<pishield.propositional_requirements.constraint.Constraint object at 0x43b4be850>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x441f3a6d0>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 13.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 10, Viol Rate:  0.075
[Checkpoint] New best avg reward: 13.40 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 37.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 44, Viol Rate:  0.087
[Checkpoint] New best avg reward: 37.30 at episode 20
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 43.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 81, Viol Rate:  0.086
[Checkpoint] New best avg reward: 43.10 at episode 30
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 49.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 103, Viol Rate:  0.072
[Checkpoint] New best avg reward: 49.10 at episode 40
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 30.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 140, Viol Rate:  0.081
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 76.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 202, Viol Rate:  0.081
[Checkpoint] New best avg reward: 76.40 at episode 60
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 126.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 256, Viol Rate:  0.068
[Checkpoint] New best avg reward: 126.70 at episode 70
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 65.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 292, Viol Rate:  0.066
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 67.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 339, Viol Rate:  0.067
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 43.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 362, Viol Rate:  0.065
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 43.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 373, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 32.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 395, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 21.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 414, Viol Rate:  0.064
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 29.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 422, Viol Rate:  0.062
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 27.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 431, Viol Rate:  0.061
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 28.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 451, Viol Rate:  0.061
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 50.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 482, Viol Rate:  0.061
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 27.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 492, Viol Rate:  0.060
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 43.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 511, Viol Rate:  0.060
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 38.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 521, Viol Rate:  0.058
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 69.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 546, Viol Rate:  0.057
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 78.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 576, Viol Rate:  0.055
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 86.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 608, Viol Rate:  0.054
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 113.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 660, Viol Rate:  0.053
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 86.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 687, Viol Rate:  0.052
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 37.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 704, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 37.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 719, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 31.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 732, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 40.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 750, Viol Rate:  0.051
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 21.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 756, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 17.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 763, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 27.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 773, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 22.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 782, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 30.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 795, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 24.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 798, Viol Rate:  0.049
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 37.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 803, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 15.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 808, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 28.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 816, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 21.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 826, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 23.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 838, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 16.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 850, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 16.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 861, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 25.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 871, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 15.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 886, Viol Rate:  0.049
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 12.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 899, Viol Rate:  0.049
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 14.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 908, Viol Rate:  0.049
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 16.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 923, Viol Rate:  0.049
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 15.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 935, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 17.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 950, Viol Rate:  0.050
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 13.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 965, Viol Rate:  0.051

[Post-Training] Loading best weights with avg reward: 126.70

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 81.00, Steps = 81, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 5, Mod Rate = 0.0000, Viol Rate = 0.0617
Episode 2/50: Reward = 33.00, Steps = 33, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0614
Episode 3/50: Reward = 20.00, Steps = 20, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0597
Episode 4/50: Reward = 39.00, Steps = 39, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 9, Mod Rate = 0.0000, Viol Rate = 0.0520
Episode 5/50: Reward = 22.00, Steps = 22, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 9, Mod Rate = 0.0000, Viol Rate = 0.0462
Episode 6/50: Reward = 106.00, Steps = 106, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 14, Mod Rate = 0.0000, Viol Rate = 0.0465
Episode 7/50: Reward = 99.00, Steps = 99, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 20, Mod Rate = 0.0000, Viol Rate = 0.0500
Episode 8/50: Reward = 41.00, Steps = 41, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 21, Mod Rate = 0.0000, Viol Rate = 0.0476                                                                                             
Episode 9/50: Reward = 50.00, Steps = 50, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 25, Mod Rate = 0.0000, Viol Rate = 0.0509
Episode 10/50: Reward = 38.00, Steps = 38, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 27, Mod Rate = 0.0000, Viol Rate = 0.0510
Episode 11/50: Reward = 16.00, Steps = 16, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 27, Mod Rate = 0.0000, Viol Rate = 0.0495
Episode 12/50: Reward = 117.00, Steps = 117, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 30, Mod Rate = 0.0000, Viol Rate = 0.0453
Episode 13/50: Reward = 30.00, Steps = 30, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.0448
Episode 14/50: Reward = 59.00, Steps = 59, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 33, Mod Rate = 0.0000, Viol Rate = 0.0439
Episode 15/50: Reward = 123.00, Steps = 123, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.0446
Episode 16/50: Reward = 82.00, Steps = 82, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 41, Mod Rate = 0.0000, Viol Rate = 0.0429
Episode 17/50: Reward = 178.00, Steps = 178, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 49, Mod Rate = 0.0000, Viol Rate = 0.0432
Episode 18/50: Reward = 33.00, Steps = 33, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.0428
Episode 19/50: Reward = 43.00, Steps = 43, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 54, Mod Rate = 0.0000, Viol Rate = 0.0446
Episode 20/50: Reward = 58.00, Steps = 58, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 56, Mod Rate = 0.0000, Viol Rate = 0.0442
Episode 21/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 56, Mod Rate = 0.0000, Viol Rate = 0.0437
Episode 22/50: Reward = 114.00, Steps = 114, Episode Modifications = 0, Episode Violations = 12, Total Modifications = 0, Total Violations = 68, Mod Rate = 0.0000, Viol Rate = 0.0488
Episode 23/50: Reward = 57.00, Steps = 57, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 68, Mod Rate = 0.0000, Viol Rate = 0.0469
Episode 24/50: Reward = 21.00, Steps = 21, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 70, Mod Rate = 0.0000, Viol Rate = 0.0476
Episode 25/50: Reward = 28.00, Steps = 28, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 71, Mod Rate = 0.0000, Viol Rate = 0.0473
Episode 26/50: Reward = 123.00, Steps = 123, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 78, Mod Rate = 0.0000, Viol Rate = 0.0481
Episode 27/50: Reward = 35.00, Steps = 35, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 80, Mod Rate = 0.0000, Viol Rate = 0.0483
Episode 28/50: Reward = 23.00, Steps = 23, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 80, Mod Rate = 0.0000, Viol Rate = 0.0476
Episode 29/50: Reward = 85.00, Steps = 85, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 87, Mod Rate = 0.0000, Viol Rate = 0.0493
Episode 30/50: Reward = 107.00, Steps = 107, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 93, Mod Rate = 0.0000, Viol Rate = 0.0497
Episode 31/50: Reward = 85.00, Steps = 85, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 98, Mod Rate = 0.0000, Viol Rate = 0.0501
Episode 32/50: Reward = 63.00, Steps = 63, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 101, Mod Rate = 0.0000, Viol Rate = 0.0500
Episode 33/50: Reward = 33.00, Steps = 33, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 103, Mod Rate = 0.0000, Viol Rate = 0.0501
Episode 34/50: Reward = 34.00, Steps = 34, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 104, Mod Rate = 0.0000, Viol Rate = 0.0498
Episode 35/50: Reward = 18.00, Steps = 18, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 104, Mod Rate = 0.0000, Viol Rate = 0.0494
Episode 36/50: Reward = 115.00, Steps = 115, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 109, Mod Rate = 0.0000, Viol Rate = 0.0491
Episode 37/50: Reward = 209.00, Steps = 209, Episode Modifications = 0, Episode Violations = 18, Total Modifications = 0, Total Violations = 127, Mod Rate = 0.0000, Viol Rate = 0.0523
Episode 38/50: Reward = 47.00, Steps = 47, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 127, Mod Rate = 0.0000, Viol Rate = 0.0513
Episode 39/50: Reward = 26.00, Steps = 26, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 127, Mod Rate = 0.0000, Viol Rate = 0.0507
Episode 40/50: Reward = 47.00, Steps = 47, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 128, Mod Rate = 0.0000, Viol Rate = 0.0502
Episode 41/50: Reward = 42.00, Steps = 42, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 130, Mod Rate = 0.0000, Viol Rate = 0.0502
Episode 42/50: Reward = 128.00, Steps = 128, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 132, Mod Rate = 0.0000, Viol Rate = 0.0485
Episode 43/50: Reward = 17.00, Steps = 17, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 133, Mod Rate = 0.0000, Viol Rate = 0.0486
Episode 44/50: Reward = 48.00, Steps = 48, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 134, Mod Rate = 0.0000, Viol Rate = 0.0481
Episode 45/50: Reward = 151.00, Steps = 151, Episode Modifications = 0, Episode Violations = 17, Total Modifications = 0, Total Violations = 151, Mod Rate = 0.0000, Viol Rate = 0.0514
Episode 46/50: Reward = 202.00, Steps = 202, Episode Modifications = 0, Episode Violations = 21, Total Modifications = 0, Total Violations = 172, Mod Rate = 0.0000, Viol Rate = 0.0548
Episode 47/50: Reward = 74.00, Steps = 74, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 174, Mod Rate = 0.0000, Viol Rate = 0.0542
Episode 48/50: Reward = 104.00, Steps = 104, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 178, Mod Rate = 0.0000, Viol Rate = 0.0537
Episode 49/50: Reward = 61.00, Steps = 61, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 181, Mod Rate = 0.0000, Viol Rate = 0.0536
Episode 50/50: Reward = 100.00, Steps = 100, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 182, Mod Rate = 0.0000, Viol Rate = 0.0523

Evaluation Summary:
Average Reward: 69.54
Standard Deviation: 48.25
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 182
Avg Constraint Violations per Step: 0.0523
[I 2025-12-26 17:30:42,400] Trial 11 finished with value: -0.5363999964239999 and parameters: {'lr': 0.00012590031313192707, 'gamma': 0.9961649685809538, 'hidden_dim': 512, 'use_orthogonal_init': False, 'num_layers': 2, 'cost_gamma': 0.9058341382736026, 'cost_lam': 0.9728938984047365, 'clip_eps': 0.183638233044922, 'ent_coef': 0.0015847754113098823, 'epochs': 10, 'batch_size': 32, 'budget': 0.2032639181952297, 'nu_lr': 0.009856519952600893}. Best is trial 10 with value: -0.01733333321777774.Best trial: 10. Best value: -0.0173333:  55%|█████▌    | 11/20 [2:20:19<2:48:22, 1122.45s/it]Best trial: 10. Best value: -0.0173333:  55%|█████▌    | 11/20 [2:20:19<2:48:22, 1122.45s/it]Best trial: 10. Best value: -0.0173333:  60%|██████    | 12/20 [2:20:19<3:35:58, 1619.76s/it]
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x476890d50>] [<pishield.propositional_requirements.constraint.Constraint object at 0x4768cbad0>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x4768d7cd0>] [<pishield.propositional_requirements.constraint.Constraint object at 0x4768d7dd0>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x31d3db6d0>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 23.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 29, Viol Rate:  0.125
[Checkpoint] New best avg reward: 23.20 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 37.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 48, Viol Rate:  0.080
[Checkpoint] New best avg reward: 37.10 at episode 20
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 37.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 74, Viol Rate:  0.076
[Checkpoint] New best avg reward: 37.20 at episode 30
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 37.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 83, Viol Rate:  0.061
[Checkpoint] New best avg reward: 37.70 at episode 40
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 24.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 98, Viol Rate:  0.061
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 22.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 119, Viol Rate:  0.065
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 19.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 128, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 23.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 142, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 70.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 175, Viol Rate:  0.059
[Checkpoint] New best avg reward: 70.20 at episode 90
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 17.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 186, Viol Rate:  0.060
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 33.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 201, Viol Rate:  0.058
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 32.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 218, Viol Rate:  0.058
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 17.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 231, Viol Rate:  0.058
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 78.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 265, Viol Rate:  0.056
[Checkpoint] New best avg reward: 78.70 at episode 140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 39.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 290, Viol Rate:  0.056
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 37.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 311, Viol Rate:  0.056
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 44.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 320, Viol Rate:  0.054
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 142.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 371, Viol Rate:  0.050
[Checkpoint] New best avg reward: 142.40 at episode 180
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 243.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 418, Viol Rate:  0.043
[Checkpoint] New best avg reward: 243.10 at episode 190
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 130.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 449, Viol Rate:  0.040
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 34.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 454, Viol Rate:  0.040
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 36.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 467, Viol Rate:  0.039
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 155.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 498, Viol Rate:  0.037
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 41.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 502, Viol Rate:  0.036
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 22.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 505, Viol Rate:  0.036
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 52.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 511, Viol Rate:  0.035
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 44.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 521, Viol Rate:  0.035
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 267.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 534, Viol Rate:  0.030
[Checkpoint] New best avg reward: 267.30 at episode 280
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 80.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 537, Viol Rate:  0.029
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 118.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 556, Viol Rate:  0.028
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 170.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 636, Viol Rate:  0.030
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 161.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 645, Viol Rate:  0.028
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 213.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 652, Viol Rate:  0.026
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 196.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 670, Viol Rate:  0.025
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 231.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 691, Viol Rate:  0.024
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 82.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 706, Viol Rate:  0.023
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 98.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 717, Viol Rate:  0.023
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 72.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 731, Viol Rate:  0.023
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 27.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 741, Viol Rate:  0.023
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 22.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 748, Viol Rate:  0.023
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 25.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 761, Viol Rate:  0.023
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 29.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 771, Viol Rate:  0.023
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 25.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 781, Viol Rate:  0.024
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 23.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 794, Viol Rate:  0.024
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 39.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 806, Viol Rate:  0.024
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 147.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 817, Viol Rate:  0.023
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 181.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 830, Viol Rate:  0.022
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 113.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 836, Viol Rate:  0.022
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 162.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 847, Viol Rate:  0.021
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 152.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 857, Viol Rate:  0.021

[Post-Training] Loading best weights with avg reward: 267.30

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 209.00, Steps = 209, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 2, Mod Rate = 0.0000, Viol Rate = 0.0096
Episode 2/50: Reward = 175.00, Steps = 175, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 2, Mod Rate = 0.0000, Viol Rate = 0.0052
Episode 3/50: Reward = 230.00, Steps = 230, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 4, Mod Rate = 0.0000, Viol Rate = 0.0065
Episode 4/50: Reward = 229.00, Steps = 229, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 4, Mod Rate = 0.0000, Viol Rate = 0.0047
Episode 5/50: Reward = 165.00, Steps = 165, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 6, Mod Rate = 0.0000, Viol Rate = 0.0060
Episode 6/50: Reward = 187.00, Steps = 187, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 6, Mod Rate = 0.0000, Viol Rate = 0.0050
Episode 7/50: Reward = 238.00, Steps = 238, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0056
Episode 8/50: Reward = 160.00, Steps = 160, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0050
Episode 9/50: Reward = 136.00, Steps = 136, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 8, Mod Rate = 0.0000, Viol Rate = 0.0046
Episode 10/50: Reward = 203.00, Steps = 203, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 12, Mod Rate = 0.0000, Viol Rate = 0.0062
Episode 11/50: Reward = 198.00, Steps = 198, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 13, Mod Rate = 0.0000, Viol Rate = 0.0061
Episode 12/50: Reward = 136.00, Steps = 136, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 14, Mod Rate = 0.0000, Viol Rate = 0.0062
Episode 13/50: Reward = 111.00, Steps = 111, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 14, Mod Rate = 0.0000, Viol Rate = 0.0059
Episode 14/50: Reward = 196.00, Steps = 196, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 14, Mod Rate = 0.0000, Viol Rate = 0.0054
Episode 15/50: Reward = 165.00, Steps = 165, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 14, Mod Rate = 0.0000, Viol Rate = 0.0051
Episode 16/50: Reward = 47.00, Steps = 47, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 15, Mod Rate = 0.0000, Viol Rate = 0.0054
Episode 17/50: Reward = 172.00, Steps = 172, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 21, Mod Rate = 0.0000, Viol Rate = 0.0071
Episode 18/50: Reward = 181.00, Steps = 181, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 24, Mod Rate = 0.0000, Viol Rate = 0.0076
Episode 19/50: Reward = 158.00, Steps = 158, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 27, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 20/50: Reward = 165.00, Steps = 165, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 28, Mod Rate = 0.0000, Viol Rate = 0.0081
Episode 21/50: Reward = 201.00, Steps = 201, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 29, Mod Rate = 0.0000, Viol Rate = 0.0079
Episode 22/50: Reward = 191.00, Steps = 191, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 30, Mod Rate = 0.0000, Viol Rate = 0.0078
Episode 23/50: Reward = 237.00, Steps = 237, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 35, Mod Rate = 0.0000, Viol Rate = 0.0086
Episode 24/50: Reward = 194.00, Steps = 194, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 35, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 25/50: Reward = 219.00, Steps = 219, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 37, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 26/50: Reward = 155.00, Steps = 155, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 37, Mod Rate = 0.0000, Viol Rate = 0.0079
Episode 27/50: Reward = 250.00, Steps = 250, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 40, Mod Rate = 0.0000, Viol Rate = 0.0081
Episode 28/50: Reward = 260.00, Steps = 260, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 43, Mod Rate = 0.0000, Viol Rate = 0.0083
Episode 29/50: Reward = 77.00, Steps = 77, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 43, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 30/50: Reward = 200.00, Steps = 200, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 47, Mod Rate = 0.0000, Viol Rate = 0.0086
Episode 31/50: Reward = 231.00, Steps = 231, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 48, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 32/50: Reward = 153.00, Steps = 153, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 48, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 33/50: Reward = 192.00, Steps = 192, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 48, Mod Rate = 0.0000, Viol Rate = 0.0080
Episode 34/50: Reward = 203.00, Steps = 203, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 53, Mod Rate = 0.0000, Viol Rate = 0.0085                                                                                             Best trial: 10. Best value: -0.0173333:  60%|██████    | 12/20 [3:25:00<3:35:58, 1619.76s/it]Best trial: 10. Best value: -0.0173333:  60%|██████    | 12/20 [3:25:00<3:35:58, 1619.76s/it]Best trial: 10. Best value: -0.0173333:  65%|██████▌   | 13/20 [3:25:00<4:28:52, 2304.67s/it]
Episode 35/50: Reward = 162.00, Steps = 162, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 54, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 36/50: Reward = 168.00, Steps = 168, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 54, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 37/50: Reward = 132.00, Steps = 132, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 57, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 38/50: Reward = 240.00, Steps = 240, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 59, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 39/50: Reward = 182.00, Steps = 182, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 59, Mod Rate = 0.0000, Viol Rate = 0.0083
Episode 40/50: Reward = 247.00, Steps = 247, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0084
Episode 41/50: Reward = 212.00, Steps = 212, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 42/50: Reward = 188.00, Steps = 188, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0080
Episode 43/50: Reward = 140.00, Steps = 140, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 66, Mod Rate = 0.0000, Viol Rate = 0.0084
Episode 44/50: Reward = 179.00, Steps = 179, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 66, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 45/50: Reward = 128.00, Steps = 128, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 67, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 46/50: Reward = 192.00, Steps = 192, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 67, Mod Rate = 0.0000, Viol Rate = 0.0080
Episode 47/50: Reward = 152.00, Steps = 152, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 67, Mod Rate = 0.0000, Viol Rate = 0.0078
Episode 48/50: Reward = 132.00, Steps = 132, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 68, Mod Rate = 0.0000, Viol Rate = 0.0078
Episode 49/50: Reward = 215.00, Steps = 215, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 68, Mod Rate = 0.0000, Viol Rate = 0.0076
Episode 50/50: Reward = 149.00, Steps = 149, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 69, Mod Rate = 0.0000, Viol Rate = 0.0076

Evaluation Summary:
Average Reward: 180.84
Standard Deviation: 42.97
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 69
Avg Constraint Violations per Step: 0.0076
[I 2025-12-26 18:35:23,085] Trial 12 finished with value: -0.20559999862933337 and parameters: {'lr': 0.0002312276793502457, 'gamma': 0.9962808494717635, 'hidden_dim': 512, 'use_orthogonal_init': False, 'num_layers': 2, 'cost_gamma': 0.9190339680983916, 'cost_lam': 0.9849319116946919, 'clip_eps': 0.18275850729438728, 'ent_coef': 0.031805445495082435, 'epochs': 10, 'batch_size': 32, 'budget': 0.19462706668841687, 'nu_lr': 0.004082716616367484}. Best is trial 10 with value: -0.01733333321777774.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x4b5229d10>] [<pishield.propositional_requirements.constraint.Constraint object at 0x4b522ae90>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x4272a5e50>] [<pishield.propositional_requirements.constraint.Constraint object at 0x48acfd890>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x4a7a983d0>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 24.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 24, Viol Rate:  0.097
[Checkpoint] New best avg reward: 24.70 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 40.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 41, Viol Rate:  0.063
[Checkpoint] New best avg reward: 40.60 at episode 20
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 38.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 103, Viol Rate:  0.100
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 37.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 138, Viol Rate:  0.098
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 49.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 223, Viol Rate:  0.117
[Checkpoint] New best avg reward: 49.80 at episode 50
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 45.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 244, Viol Rate:  0.103
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 28.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 260, Viol Rate:  0.099
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 20.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 270, Viol Rate:  0.095
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 48.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 294, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 61.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 343, Viol Rate:  0.087
[Checkpoint] New best avg reward: 61.30 at episode 100
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 58.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 380, Viol Rate:  0.084
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 67.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 406, Viol Rate:  0.078
[Checkpoint] New best avg reward: 67.60 at episode 120
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 13.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 414, Viol Rate:  0.078
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 88.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 444, Viol Rate:  0.071
[Checkpoint] New best avg reward: 88.90 at episode 140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 36.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 450, Viol Rate:  0.068
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 15.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 459, Viol Rate:  0.068
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 19.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 470, Viol Rate:  0.068
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 23.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 481, Viol Rate:  0.067
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 29.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 489, Viol Rate:  0.066
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 21.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 497, Viol Rate:  0.065
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 15.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 511, Viol Rate:  0.065
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 29.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 527, Viol Rate:  0.065
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 69.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 558, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 20.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 568, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 24.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 580, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 21.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 592, Viol Rate:  0.062
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 17.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 604, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 15.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 615, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 12.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 628, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 21.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 642, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 19.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 653, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 14.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 662, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 18.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 676, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 21.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 683, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 15.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 696, Viol Rate:  0.063
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 34.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 706, Viol Rate:  0.062
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 105.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 724, Viol Rate:  0.058
[Checkpoint] New best avg reward: 105.90 at episode 370
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 115.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 754, Viol Rate:  0.055
[Checkpoint] New best avg reward: 115.90 at episode 380
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 157.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 786, Viol Rate:  0.052
[Checkpoint] New best avg reward: 157.90 at episode 390
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 118.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 806, Viol Rate:  0.049
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 41.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 813, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 21.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 818, Viol Rate:  0.048
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 49.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 819, Viol Rate:  0.047
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 82.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 824, Viol Rate:  0.045
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 73.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 828, Viol Rate:  0.043
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 274.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 844, Viol Rate:  0.039
[Checkpoint] New best avg reward: 274.00 at episode 460
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 181.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 869, Viol Rate:  0.037
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 180.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 878, Viol Rate:  0.035
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 325.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 885, Viol Rate:  0.031
[Checkpoint] New best avg reward: 325.30 at episode 490
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 107.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 902, Viol Rate:  0.030

[Post-Training] Loading best weights with avg reward: 325.30

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 206.00, Steps = 206, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0049
Episode 2/50: Reward = 265.00, Steps = 265, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0021
Episode 3/50: Reward = 208.00, Steps = 208, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 3, Mod Rate = 0.0000, Viol Rate = 0.0044
Episode 4/50: Reward = 268.00, Steps = 268, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 7, Mod Rate = 0.0000, Viol Rate = 0.0074
Episode 5/50: Reward = 298.00, Steps = 298, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 10, Mod Rate = 0.0000, Viol Rate = 0.0080
Episode 6/50: Reward = 206.00, Steps = 206, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 11, Mod Rate = 0.0000, Viol Rate = 0.0076
Episode 7/50: Reward = 255.00, Steps = 255, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 16, Mod Rate = 0.0000, Viol Rate = 0.0094
Episode 8/50: Reward = 238.00, Steps = 238, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 20, Mod Rate = 0.0000, Viol Rate = 0.0103
Episode 9/50: Reward = 233.00, Steps = 233, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 20, Mod Rate = 0.0000, Viol Rate = 0.0092
Episode 10/50: Reward = 205.00, Steps = 205, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 21, Mod Rate = 0.0000, Viol Rate = 0.0088
Episode 11/50: Reward = 183.00, Steps = 183, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 22, Mod Rate = 0.0000, Viol Rate = 0.0086
Episode 12/50: Reward = 231.00, Steps = 231, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 22, Mod Rate = 0.0000, Viol Rate = 0.0079
Episode 13/50: Reward = 102.00, Steps = 102, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 22, Mod Rate = 0.0000, Viol Rate = 0.0076                                                                                             Best trial: 10. Best value: -0.0173333:  65%|██████▌   | 13/20 [4:33:34<4:28:52, 2304.67s/it]Best trial: 10. Best value: -0.0173333:  65%|██████▌   | 13/20 [4:33:34<4:28:52, 2304.67s/it]Best trial: 10. Best value: -0.0173333:  70%|███████   | 14/20 [4:33:34<4:45:07, 2851.29s/it]
Episode 14/50: Reward = 297.00, Steps = 297, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 27, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 15/50: Reward = 203.00, Steps = 203, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 29, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 16/50: Reward = 235.00, Steps = 235, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 29, Mod Rate = 0.0000, Viol Rate = 0.0080
Episode 17/50: Reward = 196.00, Steps = 196, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 30, Mod Rate = 0.0000, Viol Rate = 0.0078
Episode 18/50: Reward = 201.00, Steps = 201, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 30, Mod Rate = 0.0000, Viol Rate = 0.0074
Episode 19/50: Reward = 217.00, Steps = 217, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 36, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 20/50: Reward = 249.00, Steps = 249, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 38, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 21/50: Reward = 255.00, Steps = 255, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 41, Mod Rate = 0.0000, Viol Rate = 0.0086
Episode 22/50: Reward = 215.00, Steps = 215, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 42, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 23/50: Reward = 238.00, Steps = 238, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 43, Mod Rate = 0.0000, Viol Rate = 0.0083
Episode 24/50: Reward = 296.00, Steps = 296, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 45, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 25/50: Reward = 234.00, Steps = 234, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 46, Mod Rate = 0.0000, Viol Rate = 0.0080
Episode 26/50: Reward = 219.00, Steps = 219, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 46, Mod Rate = 0.0000, Viol Rate = 0.0077
Episode 27/50: Reward = 309.00, Steps = 309, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.0080
Episode 28/50: Reward = 231.00, Steps = 231, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.0077
Episode 29/50: Reward = 236.00, Steps = 236, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 57, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 30/50: Reward = 238.00, Steps = 238, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 59, Mod Rate = 0.0000, Viol Rate = 0.0085
Episode 31/50: Reward = 141.00, Steps = 141, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 60, Mod Rate = 0.0000, Viol Rate = 0.0084
Episode 32/50: Reward = 204.00, Steps = 204, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 60, Mod Rate = 0.0000, Viol Rate = 0.0082
Episode 33/50: Reward = 239.00, Steps = 239, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 60, Mod Rate = 0.0000, Viol Rate = 0.0079
Episode 34/50: Reward = 260.00, Steps = 260, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 62, Mod Rate = 0.0000, Viol Rate = 0.0079
Episode 35/50: Reward = 233.00, Steps = 233, Episode Modifications = 0, Episode Violations = 12, Total Modifications = 0, Total Violations = 74, Mod Rate = 0.0000, Viol Rate = 0.0092
Episode 36/50: Reward = 191.00, Steps = 191, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 74, Mod Rate = 0.0000, Viol Rate = 0.0090
Episode 37/50: Reward = 218.00, Steps = 218, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 75, Mod Rate = 0.0000, Viol Rate = 0.0089
Episode 38/50: Reward = 282.00, Steps = 282, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 75, Mod Rate = 0.0000, Viol Rate = 0.0086
Episode 39/50: Reward = 214.00, Steps = 214, Episode Modifications = 0, Episode Violations = 9, Total Modifications = 0, Total Violations = 84, Mod Rate = 0.0000, Viol Rate = 0.0094
Episode 40/50: Reward = 226.00, Steps = 226, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 85, Mod Rate = 0.0000, Viol Rate = 0.0093
Episode 41/50: Reward = 231.00, Steps = 231, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 86, Mod Rate = 0.0000, Viol Rate = 0.0091
Episode 42/50: Reward = 312.00, Steps = 312, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 89, Mod Rate = 0.0000, Viol Rate = 0.0092
Episode 43/50: Reward = 212.00, Steps = 212, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 89, Mod Rate = 0.0000, Viol Rate = 0.0090
Episode 44/50: Reward = 215.00, Steps = 215, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 92, Mod Rate = 0.0000, Viol Rate = 0.0091
Episode 45/50: Reward = 181.00, Steps = 181, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 93, Mod Rate = 0.0000, Viol Rate = 0.0090
Episode 46/50: Reward = 220.00, Steps = 220, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 94, Mod Rate = 0.0000, Viol Rate = 0.0089
Episode 47/50: Reward = 265.00, Steps = 265, Episode Modifications = 0, Episode Violations = 9, Total Modifications = 0, Total Violations = 103, Mod Rate = 0.0000, Viol Rate = 0.0095
Episode 48/50: Reward = 216.00, Steps = 216, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 103, Mod Rate = 0.0000, Viol Rate = 0.0093
Episode 49/50: Reward = 286.00, Steps = 286, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 103, Mod Rate = 0.0000, Viol Rate = 0.0091
Episode 50/50: Reward = 234.00, Steps = 234, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 106, Mod Rate = 0.0000, Viol Rate = 0.0092

Evaluation Summary:
Average Reward: 230.94
Standard Deviation: 39.22
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 106
Avg Constraint Violations per Step: 0.0092
[I 2025-12-26 19:43:57,445] Trial 13 finished with value: -0.5395999964026666 and parameters: {'lr': 0.00031461415085303764, 'gamma': 0.9822036505848379, 'hidden_dim': 512, 'use_orthogonal_init': False, 'num_layers': 2, 'cost_gamma': 0.971155483270151, 'cost_lam': 0.9452938521125961, 'clip_eps': 0.2060890611463955, 'ent_coef': 0.049618721840321, 'epochs': 8, 'batch_size': 32, 'budget': 0.2959318627113807, 'nu_lr': 0.004447642577008969}. Best is trial 10 with value: -0.01733333321777774.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x4d17f8f50>] [<pishield.propositional_requirements.constraint.Constraint object at 0x4d17f8350>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x4d180f610>] [<pishield.propositional_requirements.constraint.Constraint object at 0x4d180f0d0>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x14b2129d0>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 27.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 27, Viol Rate:  0.097
[Checkpoint] New best avg reward: 27.80 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 23.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 47, Viol Rate:  0.093
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 30.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 73, Viol Rate:  0.090
[Checkpoint] New best avg reward: 30.60 at episode 30
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 17.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 85, Viol Rate:  0.086
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 18.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 102, Viol Rate:  0.087
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 21.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 118, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 38.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 158, Viol Rate:  0.089
[Checkpoint] New best avg reward: 38.80 at episode 70
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 23.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 178, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 33.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 214, Viol Rate:  0.091
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 21.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 225, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 26.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 249, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 30.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 280, Viol Rate:  0.089
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 25.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 295, Viol Rate:  0.087
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 20.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 315, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 23.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 340, Viol Rate:  0.089
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 25.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 375, Viol Rate:  0.092
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 37.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 402, Viol Rate:  0.090
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 25.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 428, Viol Rate:  0.091
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 36.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 441, Viol Rate:  0.087
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 25.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 452, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 38.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 475, Viol Rate:  0.083
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 24.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 494, Viol Rate:  0.083
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 21.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 505, Viol Rate:  0.082
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 19.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 524, Viol Rate:  0.082
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 34.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 569, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 42.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 610, Viol Rate:  0.085
[Checkpoint] New best avg reward: 42.80 at episode 260
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 39.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 644, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 42.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 685, Viol Rate:  0.086
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 23.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 701, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 45.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 726, Viol Rate:  0.084
[Checkpoint] New best avg reward: 45.20 at episode 300
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 19.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 733, Viol Rate:  0.083
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 29.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 758, Viol Rate:  0.083
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 24.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 769, Viol Rate:  0.082
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 39.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 805, Viol Rate:  0.082
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 37.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 844, Viol Rate:  0.083
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 22.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 867, Viol Rate:  0.083
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 31.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 893, Viol Rate:  0.083
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 35.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 932, Viol Rate:  0.084
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 19.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 945, Viol Rate:  0.084
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 26.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 968, Viol Rate:  0.084
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 38.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1010, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 27.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1035, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 37.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1068, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 58.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1119, Viol Rate:  0.085
[Checkpoint] New best avg reward: 58.10 at episode 440
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 41.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1160, Viol Rate:  0.086
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 36.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1191, Viol Rate:  0.086
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 45.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1223, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 37.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1249, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 32.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1281, Viol Rate:  0.085
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 35.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 1307, Viol Rate:  0.085

[Post-Training] Loading best weights with avg reward: 58.10

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 29.00, Steps = 29, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 2/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0227
Episode 3/50: Reward = 25.00, Steps = 25, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 2, Mod Rate = 0.0000, Viol Rate = 0.0290
Episode 4/50: Reward = 22.00, Steps = 22, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 3, Mod Rate = 0.0000, Viol Rate = 0.0330
Episode 5/50: Reward = 17.00, Steps = 17, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 5, Mod Rate = 0.0000, Viol Rate = 0.0463
Episode 6/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 5, Mod Rate = 0.0000, Viol Rate = 0.0413
Episode 7/50: Reward = 41.00, Steps = 41, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 6, Mod Rate = 0.0000, Viol Rate = 0.0370
Episode 8/50: Reward = 59.00, Steps = 59, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 11, Mod Rate = 0.0000, Viol Rate = 0.0498
Episode 9/50: Reward = 55.00, Steps = 55, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 14, Mod Rate = 0.0000, Viol Rate = 0.0507
Episode 10/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 14, Mod Rate = 0.0000, Viol Rate = 0.0491
Episode 11/50: Reward = 83.00, Steps = 83, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 22, Mod Rate = 0.0000, Viol Rate = 0.0598
Episode 12/50: Reward = 56.00, Steps = 56, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 25, Mod Rate = 0.0000, Viol Rate = 0.0590
Episode 13/50: Reward = 27.00, Steps = 27, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 26, Mod Rate = 0.0000, Viol Rate = 0.0576
Episode 14/50: Reward = 17.00, Steps = 17, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 26, Mod Rate = 0.0000, Viol Rate = 0.0556
Episode 15/50: Reward = 36.00, Steps = 36, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 28, Mod Rate = 0.0000, Viol Rate = 0.0556
Episode 16/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 28, Mod Rate = 0.0000, Viol Rate = 0.0542
Episode 17/50: Reward = 47.00, Steps = 47, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 35, Mod Rate = 0.0000, Viol Rate = 0.0621
Episode 18/50: Reward = 36.00, Steps = 36, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 36, Mod Rate = 0.0000, Viol Rate = 0.0600
Episode 19/50: Reward = 28.00, Steps = 28, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 40, Mod Rate = 0.0000, Viol Rate = 0.0637
Episode 20/50: Reward = 27.00, Steps = 27, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 42, Mod Rate = 0.0000, Viol Rate = 0.0641
Episode 21/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 42, Mod Rate = 0.0000, Viol Rate = 0.0629
Episode 22/50: Reward = 88.00, Steps = 88, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 44, Mod Rate = 0.0000, Viol Rate = 0.0582
Episode 23/50: Reward = 45.00, Steps = 45, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 48, Mod Rate = 0.0000, Viol Rate = 0.0599
Episode 24/50: Reward = 85.00, Steps = 85, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 58, Mod Rate = 0.0000, Viol Rate = 0.0655
Episode 25/50: Reward = 71.00, Steps = 71, Episode Modifications = 0, Episode Violations = 6, Total Modifications = 0, Total Violations = 64, Mod Rate = 0.0000, Viol Rate = 0.0669
Episode 26/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 65, Mod Rate = 0.0000, Viol Rate = 0.0669
Episode 27/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 67, Mod Rate = 0.0000, Viol Rate = 0.0681
Episode 28/50: Reward = 24.00, Steps = 24, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 68, Mod Rate = 0.0000, Viol Rate = 0.0675
Episode 29/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 69, Mod Rate = 0.0000, Viol Rate = 0.0674
Episode 30/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 71, Mod Rate = 0.0000, Viol Rate = 0.0686
Episode 31/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 71, Mod Rate = 0.0000, Viol Rate = 0.0677
Episode 32/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 72, Mod Rate = 0.0000, Viol Rate = 0.0677
Episode 33/50: Reward = 49.00, Steps = 49, Episode Modifications = 0, Episode Violations = 8, Total Modifications = 0, Total Violations = 80, Mod Rate = 0.0000, Viol Rate = 0.0719
Episode 34/50: Reward = 79.00, Steps = 79, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 81, Mod Rate = 0.0000, Viol Rate = 0.0680
Episode 35/50: Reward = 23.00, Steps = 23, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 81, Mod Rate = 0.0000, Viol Rate = 0.0667
Episode 36/50: Reward = 39.00, Steps = 39, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 85, Mod Rate = 0.0000, Viol Rate = 0.0678
Episode 37/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 86, Mod Rate = 0.0000, Viol Rate = 0.0680
Episode 38/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 86, Mod Rate = 0.0000, Viol Rate = 0.0673
Episode 39/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 87, Mod Rate = 0.0000, Viol Rate = 0.0674
Episode 40/50: Reward = 15.00, Steps = 15, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 89, Mod Rate = 0.0000, Viol Rate = 0.0681                                                                                             Best trial: 10. Best value: -0.0173333:  70%|███████   | 14/20 [5:05:03<4:45:07, 2851.29s/it]Best trial: 10. Best value: -0.0173333:  70%|███████   | 14/20 [5:05:03<4:45:07, 2851.29s/it]Best trial: 10. Best value: -0.0173333:  75%|███████▌  | 15/20 [5:05:03<3:33:25, 2561.00s/it]
Episode 41/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 90, Mod Rate = 0.0000, Viol Rate = 0.0682
Episode 42/50: Reward = 27.00, Steps = 27, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 90, Mod Rate = 0.0000, Viol Rate = 0.0669
Episode 43/50: Reward = 43.00, Steps = 43, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 95, Mod Rate = 0.0000, Viol Rate = 0.0684
Episode 44/50: Reward = 23.00, Steps = 23, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 95, Mod Rate = 0.0000, Viol Rate = 0.0673
Episode 45/50: Reward = 72.00, Steps = 72, Episode Modifications = 0, Episode Violations = 7, Total Modifications = 0, Total Violations = 102, Mod Rate = 0.0000, Viol Rate = 0.0687
Episode 46/50: Reward = 30.00, Steps = 30, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 103, Mod Rate = 0.0000, Viol Rate = 0.0680
Episode 47/50: Reward = 31.00, Steps = 31, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 106, Mod Rate = 0.0000, Viol Rate = 0.0686
Episode 48/50: Reward = 24.00, Steps = 24, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 106, Mod Rate = 0.0000, Viol Rate = 0.0676
Episode 49/50: Reward = 18.00, Steps = 18, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 107, Mod Rate = 0.0000, Viol Rate = 0.0674
Episode 50/50: Reward = 32.00, Steps = 32, Episode Modifications = 0, Episode Violations = 5, Total Modifications = 0, Total Violations = 112, Mod Rate = 0.0000, Viol Rate = 0.0692

Evaluation Summary:
Average Reward: 32.38
Standard Deviation: 21.71
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 112
Avg Constraint Violations per Step: 0.0692
[I 2025-12-26 20:15:25,720] Trial 14 finished with value: -0.7841333281057778 and parameters: {'lr': 0.00010054002819358067, 'gamma': 0.9816254117161616, 'hidden_dim': 512, 'use_orthogonal_init': False, 'num_layers': 2, 'cost_gamma': 0.987826332146982, 'cost_lam': 0.9786412537352762, 'clip_eps': 0.1641825627349689, 'ent_coef': 0.001174377873320448, 'epochs': 1, 'batch_size': 128, 'budget': 0.17602620596120916, 'nu_lr': 0.00983373535583}. Best is trial 10 with value: -0.01733333321777774.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x4d1801c90>] [<pishield.propositional_requirements.constraint.Constraint object at 0x4d17d56d0>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x49f95cd90>] [<pishield.propositional_requirements.constraint.Constraint object at 0x47a9b5d90>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x4786fad10>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 13.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 12, Viol Rate:  0.088
[Checkpoint] New best avg reward: 13.60 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 25, Viol Rate:  0.109
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 8.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 37, Viol Rate:  0.116
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 8.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 48, Viol Rate:  0.119
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 10.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 62, Viol Rate:  0.123
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 23.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 110, Viol Rate:  0.148
[Checkpoint] New best avg reward: 23.90 at episode 60
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 29.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 182, Viol Rate:  0.175
[Checkpoint] New best avg reward: 29.50 at episode 70
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 80, Avg Reward (10): 58.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 266, Viol Rate:  0.164
[Checkpoint] New best avg reward: 58.50 at episode 80
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 90, Avg Reward (10): 11.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 273, Viol Rate:  0.157
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 100, Avg Reward (10): 53.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 319, Viol Rate:  0.140
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 110, Avg Reward (10): 9.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 331, Viol Rate:  0.139
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 120, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 343, Viol Rate:  0.139
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 130, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 355, Viol Rate:  0.139
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 140, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 370, Viol Rate:  0.139
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 150, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 384, Viol Rate:  0.139
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 160, Avg Reward (10): 9.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 397, Viol Rate:  0.139
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 170, Avg Reward (10): 10.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 410, Viol Rate:  0.139
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 180, Avg Reward (10): 86.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 436, Viol Rate:  0.114
[Checkpoint] New best avg reward: 86.30 at episode 180
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 190, Avg Reward (10): 50.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 464, Viol Rate:  0.107
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 200, Avg Reward (10): 9.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 471, Viol Rate:  0.106
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 210, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 473, Viol Rate:  0.105
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 220, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 484, Viol Rate:  0.105
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 230, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 497, Viol Rate:  0.105
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 240, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 511, Viol Rate:  0.106
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 250, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 524, Viol Rate:  0.107
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 260, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 538, Viol Rate:  0.108
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 270, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 548, Viol Rate:  0.108
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 280, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 559, Viol Rate:  0.108
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 290, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 571, Viol Rate:  0.108
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 300, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 584, Viol Rate:  0.109
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 310, Avg Reward (10): 9.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 599, Viol Rate:  0.110
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 320, Avg Reward (10): 9.70, Total Mods: 0, Mod Rate: 0.000, Total Violations: 615, Viol Rate:  0.111
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 330, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 628, Viol Rate:  0.111
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 340, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 642, Viol Rate:  0.112
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 350, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 653, Viol Rate:  0.112
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 360, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 666, Viol Rate:  0.112
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 370, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 681, Viol Rate:  0.113
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 380, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 691, Viol Rate:  0.113
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 390, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 703, Viol Rate:  0.113
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 400, Avg Reward (10): 9.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 713, Viol Rate:  0.113
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 410, Avg Reward (10): 8.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 724, Viol Rate:  0.113
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 420, Avg Reward (10): 8.90, Total Mods: 0, Mod Rate: 0.000, Total Violations: 735, Viol Rate:  0.113
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 430, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 748, Viol Rate:  0.114
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 440, Avg Reward (10): 9.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 759, Viol Rate:  0.114
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 450, Avg Reward (10): 9.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 771, Viol Rate:  0.114
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 460, Avg Reward (10): 9.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 783, Viol Rate:  0.114
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 470, Avg Reward (10): 9.10, Total Mods: 0, Mod Rate: 0.000, Total Violations: 796, Viol Rate:  0.115
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 480, Avg Reward (10): 8.80, Total Mods: 0, Mod Rate: 0.000, Total Violations: 807, Viol Rate:  0.115
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 490, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 819, Viol Rate:  0.115
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 500, Avg Reward (10): 9.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 832, Viol Rate:  0.115

[Post-Training] Loading best weights with avg reward: 86.30

[Evaluation] Evaluating ConstrainedPPOAgent for 50 episodes (Shield Layer: False, Shield Post: False)
Episode 1/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 2/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 3/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 0, Mod Rate = 0.0000, Viol Rate = 0.0000
Episode 4/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 1, Mod Rate = 0.0000, Viol Rate = 0.0244
Episode 5/50: Reward = 47.00, Steps = 47, Episode Modifications = 0, Episode Violations = 9, Total Modifications = 0, Total Violations = 10, Mod Rate = 0.0000, Viol Rate = 0.1136
Episode 6/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 13, Mod Rate = 0.0000, Viol Rate = 0.1300
Episode 7/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 13, Mod Rate = 0.0000, Viol Rate = 0.1171
Episode 8/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 13, Mod Rate = 0.0000, Viol Rate = 0.1066
Episode 9/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 14, Mod Rate = 0.0000, Viol Rate = 0.1053
Episode 10/50: Reward = 60.00, Steps = 60, Episode Modifications = 0, Episode Violations = 10, Total Modifications = 0, Total Violations = 24, Mod Rate = 0.0000, Viol Rate = 0.1244
Episode 11/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 24, Mod Rate = 0.0000, Viol Rate = 0.1176
Episode 12/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 27, Mod Rate = 0.0000, Viol Rate = 0.1256
Episode 13/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 4, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.1372
Episode 14/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.1308
Episode 15/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.1250
Episode 16/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 31, Mod Rate = 0.0000, Viol Rate = 0.1202
Episode 17/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 32, Mod Rate = 0.0000, Viol Rate = 0.1190
Episode 18/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 32, Mod Rate = 0.0000, Viol Rate = 0.1151
Episode 19/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 32, Mod Rate = 0.0000, Viol Rate = 0.1115
Episode 20/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 33, Mod Rate = 0.0000, Viol Rate = 0.1104
Episode 21/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 34, Mod Rate = 0.0000, Viol Rate = 0.1093
Episode 22/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 35, Mod Rate = 0.0000, Viol Rate = 0.1087                                                                                             Best trial: 10. Best value: -0.0173333:  75%|███████▌  | 15/20 [5:44:11<3:33:25, 2561.00s/it]Best trial: 10. Best value: -0.0173333:  75%|███████▌  | 15/20 [5:44:11<3:33:25, 2561.00s/it]Best trial: 10. Best value: -0.0173333:  80%|████████  | 16/20 [5:44:11<2:46:28, 2497.07s/it]
Episode 23/50: Reward = 14.00, Steps = 14, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 38, Mod Rate = 0.0000, Viol Rate = 0.1131
Episode 24/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 38, Mod Rate = 0.0000, Viol Rate = 0.1095
Episode 25/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 38, Mod Rate = 0.0000, Viol Rate = 0.1064
Episode 26/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.1057
Episode 27/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.1029
Episode 28/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.1005
Episode 29/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.0982
Episode 30/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.0958
Episode 31/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.0935
Episode 32/50: Reward = 8.00, Steps = 8, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.0918
Episode 33/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 39, Mod Rate = 0.0000, Viol Rate = 0.0897
Episode 34/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 42, Mod Rate = 0.0000, Viol Rate = 0.0940
Episode 35/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 42, Mod Rate = 0.0000, Viol Rate = 0.0921
Episode 36/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 45, Mod Rate = 0.0000, Viol Rate = 0.0964
Episode 37/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 46, Mod Rate = 0.0000, Viol Rate = 0.0966
Episode 38/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 46, Mod Rate = 0.0000, Viol Rate = 0.0947
Episode 39/50: Reward = 13.00, Steps = 13, Episode Modifications = 0, Episode Violations = 3, Total Modifications = 0, Total Violations = 49, Mod Rate = 0.0000, Viol Rate = 0.0982
Episode 40/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 49, Mod Rate = 0.0000, Viol Rate = 0.0961
Episode 41/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 50, Mod Rate = 0.0000, Viol Rate = 0.0960
Episode 42/50: Reward = 12.00, Steps = 12, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 52, Mod Rate = 0.0000, Viol Rate = 0.0976
Episode 43/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 52, Mod Rate = 0.0000, Viol Rate = 0.0956
Episode 44/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 52, Mod Rate = 0.0000, Viol Rate = 0.0937
Episode 45/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 2, Total Modifications = 0, Total Violations = 54, Mod Rate = 0.0000, Viol Rate = 0.0954
Episode 46/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 54, Mod Rate = 0.0000, Viol Rate = 0.0936
Episode 47/50: Reward = 10.00, Steps = 10, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 55, Mod Rate = 0.0000, Viol Rate = 0.0937
Episode 48/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 0, Total Modifications = 0, Total Violations = 55, Mod Rate = 0.0000, Viol Rate = 0.0923
Episode 49/50: Reward = 11.00, Steps = 11, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 56, Mod Rate = 0.0000, Viol Rate = 0.0923
Episode 50/50: Reward = 9.00, Steps = 9, Episode Modifications = 0, Episode Violations = 1, Total Modifications = 0, Total Violations = 57, Mod Rate = 0.0000, Viol Rate = 0.0925

Evaluation Summary:
Average Reward: 12.32
Standard Deviation: 8.58
Avg Shield Modifications per Step: 0.0000
Total Constraint Violations: 57
Avg Constraint Violations per Step: 0.0925
[I 2025-12-26 20:54:34,327] Trial 15 finished with value: -0.9178666605475556 and parameters: {'lr': 0.0017364940395759602, 'gamma': 0.9831342831465468, 'hidden_dim': 512, 'use_orthogonal_init': False, 'num_layers': 2, 'cost_gamma': 0.9496734029932961, 'cost_lam': 0.9951344769976385, 'clip_eps': 0.2273836812675751, 'ent_coef': 0.026736850535698402, 'epochs': 6, 'batch_size': 32, 'budget': 0.22499245877562557, 'nu_lr': 0.002691294450029068}. Best is trial 10 with value: -0.01733333321777774.
[Seed set to 42]
Observation space: Box([-4.8               -inf -0.41887903        -inf], [4.8               inf 0.41887903        inf], (4,), float32)
[DEBUG] use_cnn: False
[DEBUG] Gym observation shape: (4,)
[DEBUG] Input shape passed to ModularNetwork: (4,)
[DEBUG] Using benchmark
requirements file: src/requirements/emergency_cartpole.cnf
num vars: 4, num flags: 2
Shield ordering: 3,2,1,0
[<pishield.propositional_requirements.constraint.Constraint object at 0x4ac4d9050>] [<pishield.propositional_requirements.constraint.Constraint object at 0x4ac4d8810>]
head 0 with old rules 1
head 0 with new rules 1
head n0 with old rules 1
head n0 with new rules 2
[<pishield.propositional_requirements.constraint.Constraint object at 0x4abb34b90>] [<pishield.propositional_requirements.constraint.Constraint object at 0x4abb365d0>]
head 1 with old rules 1
head 1 with new rules 2
head n1 with old rules 1
head n1 with new rules 1
[<pishield.propositional_requirements.constraint.Constraint object at 0x478ca2f90>] []
head n2 with old rules 1
head n2 with new rules 1
Generated 2 strata of constraints with [3 2 1 0] centrality
Training ConstrainedPPOAgent agent on CartPole-v1 with shield post: False with shield layer: False with shield pre: False
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 10, Avg Reward (10): 61.50, Total Mods: 0, Mod Rate: 0.000, Total Violations: 49, Viol Rate:  0.080
[Checkpoint] New best avg reward: 61.50 at episode 10
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 20, Avg Reward (10): 71.00, Total Mods: 0, Mod Rate: 0.000, Total Violations: 128, Viol Rate:  0.097
[Checkpoint] New best avg reward: 71.00 at episode 20
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 30, Avg Reward (10): 67.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 184, Viol Rate:  0.092
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 40, Avg Reward (10): 29.40, Total Mods: 0, Mod Rate: 0.000, Total Violations: 202, Viol Rate:  0.088
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 50, Avg Reward (10): 84.20, Total Mods: 0, Mod Rate: 0.000, Total Violations: 253, Viol Rate:  0.081
[Checkpoint] New best avg reward: 84.20 at episode 50
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 60, Avg Reward (10): 31.60, Total Mods: 0, Mod Rate: 0.000, Total Violations: 268, Viol Rate:  0.078
[CartPole-v1] [ConstrainedPPOAgent] [Unshielded] [] [OBS], Episode 70, Avg Reward (10): 67.30, Total Mods: 0, Mod Rate: 0.000, Total Violations: 289, Viol Rate:  0.070/opt/anaconda3/envs/thesis_env/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
